"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const os = require("os");
const path = require("path");
const util_1 = require("util");
const fs = require("fs-extra");
const migrate_1 = require("../../lib/commands/migrate");
const mock_sdk_1 = require("../util/mock-sdk");
const exec = (0, util_1.promisify)(child_process_1.exec);
describe('Migrate Function Tests', () => {
    let sdkProvider;
    let getTemplateMock;
    let describeStacksMock;
    let cfnMocks;
    const testResourcePath = [__dirname, 'test-resources'];
    const templatePath = [...testResourcePath, 'templates'];
    const stackPath = [...testResourcePath, 'stacks'];
    const validTemplatePath = path.join(...templatePath, 's3-template.json');
    const emptyTemplatePath = path.join(...templatePath, 'empty-template.yml');
    const invalidTemplatePath = path.join(...templatePath, 'rds-template.json');
    const validTemplate = (0, migrate_1.readFromPath)(validTemplatePath);
    const invalidTemplate = (0, migrate_1.readFromPath)(invalidTemplatePath);
    beforeEach(async () => {
        sdkProvider = new mock_sdk_1.MockSdkProvider();
        getTemplateMock = jest.fn();
        describeStacksMock = jest.fn();
        cfnMocks = { getTemplate: getTemplateMock, describeStacks: describeStacksMock };
        sdkProvider.stubCloudFormation(cfnMocks);
    });
    test('parseSourceOptions throws if both --from-path and --from-stack is provided', () => {
        expect(() => (0, migrate_1.parseSourceOptions)('any-value', true, 'my-awesome-stack')).toThrowError('Only one of `--from-path` or `--from-stack` may be provided.');
    });
    test('parseSourceOptions returns from-scan when neither --from-path or --from-stack are provided', () => {
        expect((0, migrate_1.parseSourceOptions)(undefined, undefined, 'my-stack-name')).toStrictEqual({ source: migrate_1.TemplateSourceOptions.SCAN });
    });
    test('parseSourceOptions does not throw when only --from-path is supplied', () => {
        expect((0, migrate_1.parseSourceOptions)('my-file-path', undefined, 'my-stack-name')).toStrictEqual({ source: migrate_1.TemplateSourceOptions.PATH, templatePath: 'my-file-path' });
    });
    test('parseSourceOptions does now throw when only --from-stack is provided', () => {
        expect((0, migrate_1.parseSourceOptions)(undefined, true, 'my-stack-name')).toStrictEqual({ source: migrate_1.TemplateSourceOptions.STACK, stackName: 'my-stack-name' });
    });
    test('readFromPath produces a string representation of the template at a given path', () => {
        expect((0, migrate_1.readFromPath)(validTemplatePath)).toEqual(fs.readFileSync(validTemplatePath, 'utf8'));
    });
    test('readFromPath throws error when template file is empty', () => {
        expect(() => (0, migrate_1.readFromPath)(emptyTemplatePath)).toThrow(`\'${emptyTemplatePath}\' is an empty file.`);
    });
    test('readFromPath throws error when template file does not exist at a given path', () => {
        const badTemplatePath = './not-here.json';
        expect(() => (0, migrate_1.readFromPath)(badTemplatePath)).toThrowError(`\'${badTemplatePath}\' is not a valid path.`);
    });
    test('readFromStack produces a string representation of the template retrieved from CloudFormation', async () => {
        const template = fs.readFileSync(validTemplatePath, { encoding: 'utf-8' });
        getTemplateMock.mockImplementation(() => ({
            TemplateBody: template,
        }));
        describeStacksMock.mockImplementation(() => ({
            Stacks: [
                {
                    StackName: 'this-one',
                    StackStatus: 'CREATE_COMPLETE',
                },
            ],
        }));
        expect(await (0, migrate_1.readFromStack)('this-one', sdkProvider, { account: 'num', region: 'here', name: 'hello-my-name-is-what...' })).toEqual(JSON.stringify(JSON.parse(template)));
    });
    test('readFromStack throws error when no stack exists with the stack name in the account and region', async () => {
        describeStacksMock.mockImplementation(() => { throw new Error('No stack. This did not go well.'); });
        await expect(() => (0, migrate_1.readFromStack)('that-one', sdkProvider, { account: 'num', region: 'here', name: 'hello-my-name-is-who...' })).rejects.toThrow('No stack. This did not go well.');
    });
    test('readFromStack throws error when stack exists but the status is not healthy', async () => {
        describeStacksMock.mockImplementation(() => ({
            Stacks: [
                {
                    StackName: 'this-one',
                    StackStatus: 'CREATE_FAILED',
                    StackStatusReason: 'Something went wrong',
                },
            ],
        }));
        await expect(() => (0, migrate_1.readFromStack)('that-one', sdkProvider, { account: 'num', region: 'here', name: 'hello-my-name-is-chicka-chicka...' })).rejects.toThrow('Stack \'that-one\' in account num and region here has a status of \'CREATE_FAILED\' due to \'Something went wrong\'. The stack cannot be migrated until it is in a healthy state.');
    });
    test('setEnvironment sets account and region when provided', () => {
        expect((0, migrate_1.setEnvironment)('my-account', 'somewhere')).toEqual({ account: 'my-account', region: 'somewhere', name: 'cdk-migrate-env' });
    });
    test('serEnvironment uses default account and region when not provided', () => {
        expect((0, migrate_1.setEnvironment)()).toEqual({ account: 'unknown-account', region: 'unknown-region', name: 'cdk-migrate-env' });
    });
    test('generateStack generates the expected stack string when called for typescript', () => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodTypeScript', 'typescript');
        expect(stack).toEqual(fs.readFileSync(path.join(...stackPath, 's3-stack.ts'), 'utf8'));
    });
    test('generateStack generates the expected stack string when called for python', () => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodPython', 'python');
        expect(stack).toEqual(fs.readFileSync(path.join(...stackPath, 's3_stack.py'), 'utf8'));
    });
    test('generateStack generates the expected stack string when called for java', () => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodJava', 'java');
        expect(stack).toEqual(fs.readFileSync(path.join(...stackPath, 'S3Stack.java'), 'utf8'));
    });
    test('generateStack generates the expected stack string when called for csharp', () => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodCSharp', 'csharp');
        expect(stack).toEqual(fs.readFileSync(path.join(...stackPath, 'S3Stack.cs'), 'utf8'));
    });
    // TODO: fix with actual go template
    test('generateStack generates the expected stack string when called for go', () => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodGo', 'go');
        expect(stack).toEqual(fs.readFileSync(path.join(...stackPath, 's3.go'), 'utf8'));
    });
    test('generateStack throws error when called for other language', () => {
        expect(() => (0, migrate_1.generateStack)(validTemplate, 'BadBadBad', 'php')).toThrowError('BadBadBadStack could not be generated because php is not a supported language');
    });
    test('generateStack throws error for invalid resource property', () => {
        expect(() => (0, migrate_1.generateStack)(invalidTemplate, 'VeryBad', 'typescript')).toThrow('VeryBadStack could not be generated because ReadEndpoint is not a valid property for resource RDSCluster of type AWS::RDS::DBCluster');
    });
    cliTest('generateCdkApp generates the expected cdk app when called for typescript', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodTypeScript', 'typescript');
        await (0, migrate_1.generateCdkApp)('GoodTypeScript', stack, 'typescript', workDir);
        // Packages exist in the correct spot
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'package.json'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'bin', 'good_type_script.ts'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'lib', 'good_type_script-stack.ts'))).toBeTruthy();
        // Replaced stack file is referenced correctly in app file
        const app = fs.readFileSync(path.join(workDir, 'GoodTypeScript', 'bin', 'good_type_script.ts'), 'utf8').split('\n');
        expect(app.map(line => line.match('import { GoodTypeScriptStack } from \'../lib/good_type_script-stack\';')).filter(line => line).length).toEqual(1);
        expect(app.map(line => line.match(/new GoodTypeScriptStack\(app, \'GoodTypeScript\', \{/)).filter(line => line).length).toEqual(1);
        // Replaced stack file is correctly generated
        const replacedStack = fs.readFileSync(path.join(workDir, 'GoodTypeScript', 'lib', 'good_type_script-stack.ts'), 'utf8');
        expect(replacedStack).toEqual(fs.readFileSync(path.join(...stackPath, 's3-stack.ts'), 'utf8'));
    });
    cliTest('generateCdkApp adds cdk-migrate key in context', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodTypeScript', 'typescript');
        await (0, migrate_1.generateCdkApp)('GoodTypeScript', stack, 'typescript', workDir);
        // cdk.json exist in the correct spot
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'cdk.json'))).toBeTruthy();
        // cdk.json has "cdk-migrate" : true in context
        const cdkJson = fs.readJsonSync(path.join(workDir, 'GoodTypeScript', 'cdk.json'), 'utf8');
        expect(cdkJson.context['cdk-migrate']).toBeTruthy();
    });
    cliTest('generateCdkApp generates the expected cdk app when called for python', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodPython', 'python');
        await (0, migrate_1.generateCdkApp)('GoodPython', stack, 'python', workDir);
        // Packages exist in the correct spot
        expect(fs.pathExistsSync(path.join(workDir, 'GoodPython', 'requirements.txt'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodPython', 'app.py'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodPython', 'good_python', 'good_python_stack.py'))).toBeTruthy();
        // Replaced stack file is referenced correctly in app file
        const app = fs.readFileSync(path.join(workDir, 'GoodPython', 'app.py'), 'utf8').split('\n');
        expect(app.map(line => line.match('from good_python.good_python_stack import GoodPythonStack')).filter(line => line).length).toEqual(1);
        expect(app.map(line => line.match(/GoodPythonStack\(app, "GoodPython",/)).filter(line => line).length).toEqual(1);
        // Replaced stack file is correctly generated
        const replacedStack = fs.readFileSync(path.join(workDir, 'GoodPython', 'good_python', 'good_python_stack.py'), 'utf8');
        expect(replacedStack).toEqual(fs.readFileSync(path.join(...stackPath, 's3_stack.py'), 'utf8'));
    });
    cliTest('generateCdkApp generates the expected cdk app when called for java', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodJava', 'java');
        await (0, migrate_1.generateCdkApp)('GoodJava', stack, 'java', workDir);
        // Packages exist in the correct spot
        expect(fs.pathExistsSync(path.join(workDir, 'GoodJava', 'pom.xml'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodJava', 'src', 'main', 'java', 'com', 'myorg', 'GoodJavaApp.java'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodJava', 'src', 'main', 'java', 'com', 'myorg', 'GoodJavaStack.java'))).toBeTruthy();
        // Replaced stack file is referenced correctly in app file
        const app = fs.readFileSync(path.join(workDir, 'GoodJava', 'src', 'main', 'java', 'com', 'myorg', 'GoodJavaApp.java'), 'utf8').split('\n');
        expect(app.map(line => line.match('public class GoodJavaApp {')).filter(line => line).length).toEqual(1);
        expect(app.map(line => line.match(/        new GoodJavaStack\(app, "GoodJava", StackProps.builder()/)).filter(line => line).length).toEqual(1);
        // Replaced stack file is correctly generated
        const replacedStack = fs.readFileSync(path.join(workDir, 'GoodJava', 'src', 'main', 'java', 'com', 'myorg', 'GoodJavaStack.java'), 'utf8');
        expect(replacedStack).toEqual(fs.readFileSync(path.join(...stackPath, 'S3Stack.java'), 'utf8'));
    });
    cliTest('generateCdkApp generates the expected cdk app when called for csharp', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodCSharp', 'csharp');
        await (0, migrate_1.generateCdkApp)('GoodCSharp', stack, 'csharp', workDir);
        // Packages exist in the correct spot
        expect(fs.pathExistsSync(path.join(workDir, 'GoodCSharp', 'src', 'GoodCSharp.sln'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodCSharp', 'src', 'GoodCSharp', 'Program.cs'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodCSharp', 'src', 'GoodCSharp', 'GoodCSharpStack.cs'))).toBeTruthy();
        // Replaced stack file is referenced correctly in app file
        const app = fs.readFileSync(path.join(workDir, 'GoodCSharp', 'src', 'GoodCSharp', 'Program.cs'), 'utf8').split('\n');
        expect(app.map(line => line.match('namespace GoodCSharp')).filter(line => line).length).toEqual(1);
        expect(app.map(line => line.match(/        new GoodCSharpStack\(app, "GoodCSharp", new GoodCSharpStackProps/)).filter(line => line).length).toEqual(1);
        // Replaced stack file is correctly generated
        const replacedStack = fs.readFileSync(path.join(workDir, 'GoodCSharp', 'src', 'GoodCSharp', 'GoodCSharpStack.cs'), 'utf8');
        expect(replacedStack).toEqual(fs.readFileSync(path.join(...stackPath, 'S3Stack.cs'), 'utf8'));
    });
    cliTest('generatedCdkApp generates the expected cdk app when called for go', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodGo', 'go');
        await (0, migrate_1.generateCdkApp)('GoodGo', stack, 'go', workDir);
        expect(fs.pathExists(path.join(workDir, 's3.go'))).toBeTruthy();
        const app = fs.readFileSync(path.join(workDir, 'GoodGo', 'good_go.go'), 'utf8').split('\n');
        expect(app.map(line => line.match(/func NewGoodGoStack\(scope constructs.Construct, id string, props \*GoodGoStackProps\) \*GoodGoStack \{/)).filter(line => line).length).toEqual(1);
        expect(app.map(line => line.match(/    NewGoodGoStack\(app, "GoodGo", &GoodGoStackProps\{/)));
    });
    cliTest('generatedCdkApp generates a zip file when --compress is used', async (workDir) => {
        const stack = (0, migrate_1.generateStack)(validTemplate, 'GoodTypeScript', 'typescript');
        await (0, migrate_1.generateCdkApp)('GoodTypeScript', stack, 'typescript', workDir, true);
        // Packages not in outDir
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'package.json'))).toBeFalsy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'bin', 'good_type_script.ts'))).toBeFalsy();
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript', 'lib', 'good_type_script-stack.ts'))).toBeFalsy();
        // Zip file exists
        expect(fs.pathExistsSync(path.join(workDir, 'GoodTypeScript.zip'))).toBeTruthy();
        // Unzip it
        await exec(`unzip ${path.join(workDir, 'GoodTypeScript.zip')}`, { cwd: workDir });
        // Now the files should be there
        expect(fs.pathExistsSync(path.join(workDir, 'package.json'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'bin', 'good_type_script.ts'))).toBeTruthy();
        expect(fs.pathExistsSync(path.join(workDir, 'lib', 'good_type_script-stack.ts'))).toBeTruthy();
    });
});
function cliTest(name, handler) {
    test(name, () => withTempDir(handler));
}
async function withTempDir(cb) {
    const tmpDir = await fs.mkdtemp(path.join(os.tmpdir(), 'aws-cdk-test'));
    try {
        await cb(tmpDir);
    }
    finally {
        await fs.remove(tmpDir);
    }
}
describe('generateTemplate', () => {
    let sdkProvider;
    let cloudFormationMocks;
    const sampleResource = {
        ResourceType: 'AWS::S3::Bucket',
        ManagedByStack: true,
        ResourceIdentifier: { 'my-key': 'my-bucket' },
        LogicalResourceId: 'my-bucket',
    };
    const sampleResource2 = {
        ResourceType: 'AWS::EC2::Instance',
        ResourceIdentifier: {
            instanceId: 'i-1234567890abcdef0',
        },
        LogicalResourceId: 'my-ec2-instance',
        ManagedByStack: true,
    };
    const stackName = 'my-stack';
    const environment = (0, migrate_1.setEnvironment)('123456789012', 'us-east-1');
    const scanId = 'fake-scan-id';
    const defaultExpectedResult = {
        migrateJson: {
            resources: [
                {
                    LogicalResourceId: 'my-bucket',
                    ResourceIdentifier: { 'my-key': 'my-bucket' },
                    ResourceType: 'AWS::S3::Bucket',
                },
                {
                    LogicalResourceId: 'my-ec2-instance',
                    ResourceIdentifier: { instanceId: 'i-1234567890abcdef0' },
                    ResourceType: 'AWS::EC2::Instance',
                },
            ],
            source: 'template-arn',
            templateBody: 'template-body',
        },
        resources: [
            {
                LogicalResourceId: 'my-bucket',
                ManagedByStack: true,
                ResourceIdentifier: {
                    'my-key': 'my-bucket',
                },
                ResourceType: 'AWS::S3::Bucket',
            },
            {
                LogicalResourceId: 'my-ec2-instance',
                ManagedByStack: true,
                ResourceIdentifier: {
                    instanceId: 'i-1234567890abcdef0',
                },
                ResourceType: 'AWS::EC2::Instance',
            },
        ],
    };
    beforeEach(() => {
        sdkProvider = new mock_sdk_1.MockSdkProvider();
        cloudFormationMocks = {
            startResourceScan: jest.fn(),
            listResourceScans: jest.fn(),
            describeResourceScan: jest.fn(),
            listResourceScanResources: jest.fn(),
            createGeneratedTemplate: jest.fn(),
            describeGeneratedTemplate: jest.fn(),
            getGeneratedTemplate: jest.fn(),
            listResourceScanRelatedResources: jest.fn(),
            config: {
                getCredentials: jest.fn(),
                getToken: jest.fn(),
                loadFromPath: jest.fn(),
                update: jest.fn(),
                getPromisesDependency: jest.fn(),
                setPromisesDependency: jest.fn(),
                customUserAgent: 'cdk-migrate',
            },
        };
        sdkProvider.stubCloudFormation(cloudFormationMocks);
    });
    test('generateTemplate successfully generates template with a new scan', async () => {
        const resourceScanSummaries = [{ ResourceScanId: scanId, Status: 'COMPLETE', PercentageCompleted: 100 }];
        cloudFormationMocks.startResourceScan.mockReturnValue({ ResourceScanId: scanId });
        cloudFormationMocks.listResourceScans.mockReturnValue({ ResourceScanSummaries: resourceScanSummaries });
        cloudFormationMocks.describeResourceScan.mockReturnValue({ Status: 'COMPLETED' });
        cloudFormationMocks.listResourceScanResources.mockReturnValue({ Resources: [sampleResource2] });
        cloudFormationMocks.createGeneratedTemplate.mockReturnValue({ GeneratedTemplateId: 'template-arn' });
        cloudFormationMocks.describeGeneratedTemplate.mockReturnValue({ Status: 'COMPLETE', Resources: [sampleResource, sampleResource2] });
        cloudFormationMocks.getGeneratedTemplate.mockReturnValue({ TemplateBody: 'template-body' });
        cloudFormationMocks.listResourceScanRelatedResources.mockReturnValue({ RelatedResources: [sampleResource] });
        const opts = {
            stackName: stackName,
            filters: [],
            fromScan: migrate_1.FromScan.NEW,
            sdkProvider: sdkProvider,
            environment: environment,
        };
        const template = await (0, migrate_1.generateTemplate)(opts);
        expect(template).toEqual(defaultExpectedResult);
    });
    test('generateTemplate successfully defaults to latest scan instead of starting a new one', async () => {
        const resourceScanSummaryComplete = [{ ResourceScanId: scanId, Status: 'COMPLETE', PercentageCompleted: 100 }];
        const resourceScanSummaryInProgress = [{ ResourceScanId: scanId, Status: 'IN_PROGRESS', PercentageCompleted: 50 }];
        cloudFormationMocks.startResourceScan.mockImplementation(() => { throw new Error('No >:('); });
        cloudFormationMocks.listResourceScans.mockReturnValueOnce({ ResourceScanSummaries: resourceScanSummaryInProgress });
        cloudFormationMocks.listResourceScans.mockReturnValueOnce({ ResourceScanSummaries: resourceScanSummaryComplete });
        cloudFormationMocks.describeResourceScan.mockReturnValue({ Status: 'COMPLETED' });
        cloudFormationMocks.listResourceScanResources.mockReturnValue({ Resources: [sampleResource2] });
        cloudFormationMocks.createGeneratedTemplate.mockReturnValue({ GeneratedTemplateId: 'template-arn' });
        cloudFormationMocks.describeGeneratedTemplate.mockReturnValue({ Status: 'COMPLETE', Resources: [sampleResource, sampleResource2] });
        cloudFormationMocks.getGeneratedTemplate.mockReturnValue({ TemplateBody: 'template-body' });
        cloudFormationMocks.listResourceScanRelatedResources.mockReturnValue({ RelatedResources: [sampleResource2] });
        const opts = {
            stackName: stackName,
            filters: [],
            newScan: true,
            sdkProvider: sdkProvider,
            environment: environment,
        };
        const template = await (0, migrate_1.generateTemplate)(opts);
        expect(template).toEqual(defaultExpectedResult);
    });
    test('generateTemplate throws an error when from-scan most-recent is passed but no scans are found.', async () => {
        const resourceScanSummaries = [];
        cloudFormationMocks.listResourceScans.mockReturnValue({ ResourceScanSummaries: resourceScanSummaries });
        const opts = {
            stackName: stackName,
            filters: [],
            fromScan: migrate_1.FromScan.MOST_RECENT,
            sdkProvider: sdkProvider,
            environment: environment,
        };
        await expect((0, migrate_1.generateTemplate)(opts)).rejects.toThrow('No scans found. Please either start a new scan with the `--from-scan` new or do not specify a `--from-scan` option.');
    });
    test('generateTemplate throws an error when an invalid key is passed in the filters', async () => {
        const resourceScanSummaries = [{ ResourceScanId: scanId, Status: 'COMPLETE', PercentageCompleted: 100 }];
        cloudFormationMocks.startResourceScan.mockReturnValue({ ResourceScanId: scanId });
        cloudFormationMocks.listResourceScans.mockReturnValue({ ResourceScanSummaries: resourceScanSummaries });
        cloudFormationMocks.describeResourceScan.mockReturnValue({ Status: 'COMPLETED' });
        cloudFormationMocks.listResourceScanResources.mockReturnValue({ Resources: [sampleResource2] });
        cloudFormationMocks.createGeneratedTemplate.mockReturnValue({ GeneratedTemplateId: 'template-arn' });
        cloudFormationMocks.describeGeneratedTemplate.mockReturnValue({ Status: 'COMPLETE' });
        cloudFormationMocks.getGeneratedTemplate.mockReturnValue({ TemplateBody: 'template-body' });
        cloudFormationMocks.listResourceScanRelatedResources.mockReturnValue({ RelatedResources: [sampleResource] });
        const opts = {
            stackName: stackName,
            filters: ['invalid-key=invalid-value'],
            fromScan: migrate_1.FromScan.MOST_RECENT,
            sdkProvider: sdkProvider,
            environment: environment,
        };
        await expect((0, migrate_1.generateTemplate)(opts)).rejects.toThrow('Invalid filter: invalid-key');
    });
    test('generateTemplate defaults to starting a new scan when no options are provided', async () => {
        const resourceScanSummaryComplete = [{ ResourceScanId: scanId, Status: 'COMPLETE', PercentageCompleted: 100 }];
        const resourceScanSummaryInProgress = [{ ResourceScanId: scanId, Status: 'IN_PROGRESS', PercentageCompleted: 50 }];
        cloudFormationMocks.startResourceScan.mockReturnValue({ ResourceScanId: scanId });
        cloudFormationMocks.listResourceScans.mockReturnValueOnce({ ResourceScanSummaries: undefined });
        cloudFormationMocks.listResourceScans.mockReturnValueOnce({ ResourceScanSummaries: resourceScanSummaryInProgress });
        cloudFormationMocks.listResourceScans.mockReturnValueOnce({ ResourceScanSummaries: resourceScanSummaryComplete });
        cloudFormationMocks.describeResourceScan.mockReturnValue({ Status: 'COMPLETED' });
        cloudFormationMocks.listResourceScanResources.mockReturnValue({ Resources: [sampleResource2] });
        cloudFormationMocks.createGeneratedTemplate.mockReturnValue({ GeneratedTemplateId: 'template-arn' });
        cloudFormationMocks.describeGeneratedTemplate.mockReturnValue({ Status: 'COMPLETE', Resources: [sampleResource, sampleResource2] });
        cloudFormationMocks.getGeneratedTemplate.mockReturnValue({ TemplateBody: 'template-body' });
        cloudFormationMocks.listResourceScanRelatedResources.mockReturnValue({ RelatedResources: [sampleResource] });
        const opts = {
            stackName: stackName,
            sdkProvider: sdkProvider,
            environment: environment,
        };
        const template = await (0, migrate_1.generateTemplate)(opts);
        expect(template).toEqual(defaultExpectedResult);
        expect(cloudFormationMocks.startResourceScan).toHaveBeenCalled();
    });
    test('generateTemplate successfully generates templates with valid filter options', async () => {
        const resourceScanSummaries = [{ ResourceScanId: scanId, Status: 'COMPLETE', PercentageCompleted: 100 }];
        cloudFormationMocks.startResourceScan.mockReturnValue({ ResourceScanId: scanId });
        cloudFormationMocks.listResourceScans.mockReturnValue({ ResourceScanSummaries: resourceScanSummaries });
        cloudFormationMocks.describeResourceScan.mockReturnValue({ Status: 'COMPLETED' });
        cloudFormationMocks.listResourceScanResources.mockReturnValue({ Resources: [sampleResource2] });
        cloudFormationMocks.createGeneratedTemplate.mockReturnValue({ GeneratedTemplateId: 'template-arn' });
        cloudFormationMocks.describeGeneratedTemplate.mockReturnValue({ Status: 'COMPLETE', Resources: [sampleResource, sampleResource2] });
        cloudFormationMocks.getGeneratedTemplate.mockReturnValue({ TemplateBody: 'template-body' });
        cloudFormationMocks.listResourceScanRelatedResources.mockReturnValue({ RelatedResources: [sampleResource] });
        const opts = {
            stackName: stackName,
            filters: ['type=AWS::S3::Bucket,identifier={"my-key":"my-bucket"}', 'type=AWS::EC2::Instance'],
            sdkProvider: sdkProvider,
            environment: environment,
        };
        const template = await (0, migrate_1.generateTemplate)(opts);
        expect(template).toEqual(defaultExpectedResult);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlncmF0ZS50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibWlncmF0ZS50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaURBQThDO0FBQzlDLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0IsK0JBQWlDO0FBRWpDLCtCQUErQjtBQUMvQix3REFBd047QUFDeE4sK0NBQXNGO0FBRXRGLE1BQU0sSUFBSSxHQUFHLElBQUEsZ0JBQVMsRUFBQyxvQkFBSyxDQUFDLENBQUM7QUFFOUIsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUN0QyxJQUFJLFdBQTRCLENBQUM7SUFDakMsSUFBSSxlQUEwQixDQUFDO0lBQy9CLElBQUksa0JBQTZCLENBQUM7SUFDbEMsSUFBSSxRQUErRCxDQUFDO0lBRXBFLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxTQUFTLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztJQUN2RCxNQUFNLFlBQVksR0FBRyxDQUFDLEdBQUcsZ0JBQWdCLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDeEQsTUFBTSxTQUFTLEdBQUcsQ0FBQyxHQUFHLGdCQUFnQixFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRWxELE1BQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLFlBQVksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO0lBQ3pFLE1BQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLFlBQVksRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO0lBQzNFLE1BQU0sbUJBQW1CLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLFlBQVksRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO0lBQzVFLE1BQU0sYUFBYSxHQUFHLElBQUEsc0JBQVksRUFBQyxpQkFBaUIsQ0FBRSxDQUFDO0lBQ3ZELE1BQU0sZUFBZSxHQUFHLElBQUEsc0JBQVksRUFBQyxtQkFBbUIsQ0FBRSxDQUFDO0lBRTNELFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQixXQUFXLEdBQUcsSUFBSSwwQkFBZSxFQUFFLENBQUM7UUFDcEMsZUFBZSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUM1QixrQkFBa0IsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDL0IsUUFBUSxHQUFHLEVBQUUsV0FBVyxFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsQ0FBQztRQUNoRixXQUFXLENBQUMsa0JBQWtCLENBQUMsUUFBZSxDQUFDLENBQUM7SUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsNEVBQTRFLEVBQUUsR0FBRyxFQUFFO1FBQ3RGLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLDRCQUFrQixFQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyw4REFBOEQsQ0FBQyxDQUFDO0lBQ3ZKLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDRGQUE0RixFQUFFLEdBQUcsRUFBRTtRQUN0RyxNQUFNLENBQUMsSUFBQSw0QkFBa0IsRUFBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUUsTUFBTSxFQUFFLCtCQUFxQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7SUFDMUgsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMscUVBQXFFLEVBQUUsR0FBRyxFQUFFO1FBQy9FLE1BQU0sQ0FBQyxJQUFBLDRCQUFrQixFQUFDLGNBQWMsRUFBRSxTQUFTLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsRUFBRSxNQUFNLEVBQUUsK0JBQXFCLENBQUMsSUFBSSxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDO0lBQzdKLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLHNFQUFzRSxFQUFFLEdBQUcsRUFBRTtRQUNoRixNQUFNLENBQUMsSUFBQSw0QkFBa0IsRUFBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUUsTUFBTSxFQUFFLCtCQUFxQixDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLENBQUMsQ0FBQztJQUNsSixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywrRUFBK0UsRUFBRSxHQUFHLEVBQUU7UUFDekYsTUFBTSxDQUFDLElBQUEsc0JBQVksRUFBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUM5RixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyx1REFBdUQsRUFBRSxHQUFHLEVBQUU7UUFDakUsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUEsc0JBQVksRUFBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssaUJBQWlCLHNCQUFzQixDQUFDLENBQUM7SUFDdEcsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsNkVBQTZFLEVBQUUsR0FBRyxFQUFFO1FBQ3ZGLE1BQU0sZUFBZSxHQUFHLGlCQUFpQixDQUFDO1FBQzFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHNCQUFZLEVBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsS0FBSyxlQUFlLHlCQUF5QixDQUFDLENBQUM7SUFDMUcsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsOEZBQThGLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDOUcsTUFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQzNFLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ3hDLFlBQVksRUFBRSxRQUFRO1NBQ3ZCLENBQUMsQ0FBQyxDQUFDO1FBRUosa0JBQWtCLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUMzQyxNQUFNLEVBQUU7Z0JBQ047b0JBQ0UsU0FBUyxFQUFFLFVBQVU7b0JBQ3JCLFdBQVcsRUFBRSxpQkFBaUI7aUJBQy9CO2FBQ0Y7U0FDRixDQUFDLENBQUMsQ0FBQztRQUVKLE1BQU0sQ0FBQyxNQUFNLElBQUEsdUJBQWEsRUFBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSwwQkFBMEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzSyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywrRkFBK0YsRUFBRSxLQUFLLElBQUksRUFBRTtRQUMvRyxrQkFBa0IsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsR0FBRyxNQUFNLElBQUksS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyRyxNQUFNLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHVCQUFhLEVBQUMsVUFBVSxFQUFFLFdBQVcsRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUseUJBQXlCLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO0lBQ3JMLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDRFQUE0RSxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzVGLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7WUFDM0MsTUFBTSxFQUFFO2dCQUNOO29CQUNFLFNBQVMsRUFBRSxVQUFVO29CQUNyQixXQUFXLEVBQUUsZUFBZTtvQkFDNUIsaUJBQWlCLEVBQUUsc0JBQXNCO2lCQUMxQzthQUNGO1NBQ0YsQ0FBQyxDQUFDLENBQUM7UUFFSixNQUFNLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHVCQUFhLEVBQUMsVUFBVSxFQUFFLFdBQVcsRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsbUNBQW1DLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxtTEFBbUwsQ0FBQyxDQUFDO0lBQ2pWLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLHNEQUFzRCxFQUFFLEdBQUcsRUFBRTtRQUNoRSxNQUFNLENBQUMsSUFBQSx3QkFBYyxFQUFDLFlBQVksRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO0lBQ3JJLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLGtFQUFrRSxFQUFFLEdBQUcsRUFBRTtRQUM1RSxNQUFNLENBQUMsSUFBQSx3QkFBYyxHQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxFQUFFLGdCQUFnQixFQUFFLElBQUksRUFBRSxpQkFBaUIsRUFBRSxDQUFDLENBQUM7SUFDdEgsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsOEVBQThFLEVBQUUsR0FBRyxFQUFFO1FBQ3hGLE1BQU0sS0FBSyxHQUFHLElBQUEsdUJBQWEsRUFBQyxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDM0UsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsYUFBYSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN6RixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywwRUFBMEUsRUFBRSxHQUFHLEVBQUU7UUFDcEYsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbkUsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsYUFBYSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN6RixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyx3RUFBd0UsRUFBRSxHQUFHLEVBQUU7UUFDbEYsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxVQUFVLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDL0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsY0FBYyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUMxRixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywwRUFBMEUsRUFBRSxHQUFHLEVBQUU7UUFDcEYsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbkUsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsWUFBWSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN4RixDQUFDLENBQUMsQ0FBQztJQUVILG9DQUFvQztJQUNwQyxJQUFJLENBQUMsc0VBQXNFLEVBQUUsR0FBRyxFQUFFO1FBQ2hGLE1BQU0sS0FBSyxHQUFHLElBQUEsdUJBQWEsRUFBQyxhQUFhLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzNELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsU0FBUyxFQUFFLE9BQU8sQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDbkYsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsMkRBQTJELEVBQUUsR0FBRyxFQUFFO1FBQ3JFLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHVCQUFhLEVBQUMsYUFBYSxFQUFFLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQywrRUFBK0UsQ0FBQyxDQUFDO0lBQy9KLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDBEQUEwRCxFQUFFLEdBQUcsRUFBRTtRQUNwRSxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBQSx1QkFBYSxFQUFDLGVBQWUsRUFBRSxTQUFTLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsc0lBQXNJLENBQUMsQ0FBQztJQUN4TixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQywwRUFBMEUsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDcEcsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLENBQUMsQ0FBQztRQUMzRSxNQUFNLElBQUEsd0JBQWMsRUFBQyxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXJFLHFDQUFxQztRQUNyQyxNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDN0YsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzNHLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGdCQUFnQixFQUFFLEtBQUssRUFBRSwyQkFBMkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUVqSCwwREFBMEQ7UUFDMUQsTUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUscUJBQXFCLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEgsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLHdFQUF3RSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckosTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLHNEQUFzRCxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbkksNkNBQTZDO1FBQzdDLE1BQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLDJCQUEyQixDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDeEgsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsYUFBYSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNqRyxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDMUUsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLENBQUMsQ0FBQztRQUMzRSxNQUFNLElBQUEsd0JBQWMsRUFBQyxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXJFLHFDQUFxQztRQUNyQyxNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFekYsK0NBQStDO1FBQy9DLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDMUYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUN0RCxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxzRUFBc0UsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDaEcsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbkUsTUFBTSxJQUFBLHdCQUFjLEVBQUMsWUFBWSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFN0QscUNBQXFDO1FBQ3JDLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUM3RixNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ25GLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxhQUFhLEVBQUUsc0JBQXNCLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFaEgsMERBQTBEO1FBQzFELE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLFFBQVEsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1RixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsMkRBQTJELENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4SSxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMscUNBQXFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVsSCw2Q0FBNkM7UUFDN0MsTUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsYUFBYSxFQUFFLHNCQUFzQixDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDdkgsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsYUFBYSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNqRyxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxvRUFBb0UsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDOUYsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxVQUFVLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDL0QsTUFBTSxJQUFBLHdCQUFjLEVBQUMsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFekQscUNBQXFDO1FBQ3JDLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDbEYsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDbEksTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFcEksMERBQTBEO1FBQzFELE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsa0JBQWtCLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGtFQUFrRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFL0ksNkNBQTZDO1FBQzdDLE1BQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsb0JBQW9CLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUMzSSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsRUFBRSxjQUFjLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ2xHLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxDQUFDLHNFQUFzRSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsRUFBRTtRQUNoRyxNQUFNLEtBQUssR0FBRyxJQUFBLHVCQUFhLEVBQUMsYUFBYSxFQUFFLFlBQVksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNuRSxNQUFNLElBQUEsd0JBQWMsRUFBQyxZQUFZLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUU3RCxxQ0FBcUM7UUFDckMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsRyxNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDNUcsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFcEgsMERBQTBEO1FBQzFELE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsWUFBWSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JILE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25HLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQywwRUFBMEUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXZKLDZDQUE2QztRQUM3QyxNQUFNLGFBQWEsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLG9CQUFvQixDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDM0gsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsWUFBWSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNoRyxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxtRUFBbUUsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEVBQUU7UUFDN0YsTUFBTSxLQUFLLEdBQUcsSUFBQSx1QkFBYSxFQUFDLGFBQWEsRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDM0QsTUFBTSxJQUFBLHdCQUFjLEVBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFckQsTUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ2hFLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFlBQVksQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1RixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMseUdBQXlHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0TCxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsd0RBQXdELENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEcsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsOERBQThELEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxFQUFFO1FBQ3hGLE1BQU0sS0FBSyxHQUFHLElBQUEsdUJBQWEsRUFBQyxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDM0UsTUFBTSxJQUFBLHdCQUFjLEVBQUMsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFM0UseUJBQXlCO1FBQ3pCLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGdCQUFnQixFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUM1RixNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDMUcsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLDJCQUEyQixDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBRWhILGtCQUFrQjtRQUNsQixNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUVqRixXQUFXO1FBQ1gsTUFBTSxJQUFJLENBQUMsU0FBUyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUVsRixnQ0FBZ0M7UUFDaEMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzNFLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUN6RixNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsMkJBQTJCLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDakcsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFNBQVMsT0FBTyxDQUFDLElBQVksRUFBRSxPQUE2QztJQUMxRSxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxLQUFLLFVBQVUsV0FBVyxDQUFDLEVBQXdDO0lBQ2pFLE1BQU0sTUFBTSxHQUFHLE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDO0lBQ3hFLElBQUksQ0FBQztRQUNILE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ25CLENBQUM7WUFBUyxDQUFDO1FBQ1QsTUFBTSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzFCLENBQUM7QUFDSCxDQUFDO0FBRUQsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLFdBQTRCLENBQUM7SUFDakMsSUFBSSxtQkFBMEUsQ0FBQztJQUMvRSxNQUFNLGNBQWMsR0FBRztRQUNyQixZQUFZLEVBQUUsaUJBQWlCO1FBQy9CLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLGtCQUFrQixFQUFFLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRTtRQUM3QyxpQkFBaUIsRUFBRSxXQUFXO0tBQy9CLENBQUM7SUFDRixNQUFNLGVBQWUsR0FBRztRQUN0QixZQUFZLEVBQUUsb0JBQW9CO1FBQ2xDLGtCQUFrQixFQUFFO1lBQ2xCLFVBQVUsRUFBRSxxQkFBcUI7U0FDbEM7UUFDRCxpQkFBaUIsRUFBRSxpQkFBaUI7UUFDcEMsY0FBYyxFQUFFLElBQUk7S0FDckIsQ0FBQztJQUNGLE1BQU0sU0FBUyxHQUFHLFVBQVUsQ0FBQztJQUM3QixNQUFNLFdBQVcsR0FBRyxJQUFBLHdCQUFjLEVBQUMsY0FBYyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQztJQUM5QixNQUFNLHFCQUFxQixHQUFHO1FBQzVCLFdBQVcsRUFBRTtZQUNYLFNBQVMsRUFBRTtnQkFDVDtvQkFDRSxpQkFBaUIsRUFBRSxXQUFXO29CQUM5QixrQkFBa0IsRUFBRSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUU7b0JBQzdDLFlBQVksRUFBRSxpQkFBaUI7aUJBQ2hDO2dCQUNEO29CQUNFLGlCQUFpQixFQUFFLGlCQUFpQjtvQkFDcEMsa0JBQWtCLEVBQUUsRUFBRSxVQUFVLEVBQUUscUJBQXFCLEVBQUU7b0JBQ3pELFlBQVksRUFBRSxvQkFBb0I7aUJBQ25DO2FBQ0Y7WUFDRCxNQUFNLEVBQUUsY0FBYztZQUN0QixZQUFZLEVBQUUsZUFBZTtTQUM5QjtRQUNELFNBQVMsRUFBRTtZQUNUO2dCQUNFLGlCQUFpQixFQUFFLFdBQVc7Z0JBQzlCLGNBQWMsRUFBRSxJQUFJO2dCQUNwQixrQkFBa0IsRUFBRTtvQkFDbEIsUUFBUSxFQUFFLFdBQVc7aUJBQ3RCO2dCQUNELFlBQVksRUFBRSxpQkFBaUI7YUFDaEM7WUFDRDtnQkFDRSxpQkFBaUIsRUFBRSxpQkFBaUI7Z0JBQ3BDLGNBQWMsRUFBRSxJQUFJO2dCQUNwQixrQkFBa0IsRUFBRTtvQkFDbEIsVUFBVSxFQUFFLHFCQUFxQjtpQkFDbEM7Z0JBQ0QsWUFBWSxFQUFFLG9CQUFvQjthQUNuQztTQUNGO0tBQ0YsQ0FBQztJQUVGLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxXQUFXLEdBQUcsSUFBSSwwQkFBZSxFQUFFLENBQUM7UUFDcEMsbUJBQW1CLEdBQUc7WUFDcEIsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUM1QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQzVCLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDL0IseUJBQXlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNwQyx1QkFBdUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xDLHlCQUF5QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDcEMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUMvQixnQ0FBZ0MsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQzNDLE1BQU0sRUFBRTtnQkFDTixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDekIsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Z0JBQ25CLFlBQVksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUN2QixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDakIscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDaEMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDaEMsZUFBZSxFQUFFLGFBQWE7YUFDL0I7U0FDRixDQUFDO1FBRUYsV0FBVyxDQUFDLGtCQUFrQixDQUFDLG1CQUEwQixDQUFDLENBQUM7SUFDN0QsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsa0VBQWtFLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDbEYsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFFekcsbUJBQW1CLENBQUMsaUJBQWtCLENBQUMsZUFBZSxDQUFDLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDbkYsbUJBQW1CLENBQUMsaUJBQWtCLENBQUMsZUFBZSxDQUFDLEVBQUUscUJBQXFCLEVBQUUscUJBQXFCLEVBQUUsQ0FBQyxDQUFDO1FBQ3pHLG1CQUFtQixDQUFDLG9CQUFxQixDQUFDLGVBQWUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ25GLG1CQUFtQixDQUFDLHlCQUEwQixDQUFDLGVBQWUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNqRyxtQkFBbUIsQ0FBQyx1QkFBd0IsQ0FBQyxlQUFlLENBQUMsRUFBRSxtQkFBbUIsRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDO1FBQ3RHLG1CQUFtQixDQUFDLHlCQUEwQixDQUFDLGVBQWUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQUMsY0FBYyxFQUFFLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNySSxtQkFBbUIsQ0FBQyxvQkFBcUIsQ0FBQyxlQUFlLENBQUMsRUFBRSxZQUFZLEVBQUUsZUFBZSxFQUFFLENBQUMsQ0FBQztRQUM3RixtQkFBbUIsQ0FBQyxnQ0FBaUMsQ0FBQyxlQUFlLENBQUMsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUU5RyxNQUFNLElBQUksR0FBNEI7WUFDcEMsU0FBUyxFQUFFLFNBQVM7WUFDcEIsT0FBTyxFQUFFLEVBQUU7WUFDWCxRQUFRLEVBQUUsa0JBQVEsQ0FBQyxHQUFHO1lBQ3RCLFdBQVcsRUFBRSxXQUFXO1lBQ3hCLFdBQVcsRUFBRSxXQUFXO1NBQ3pCLENBQUM7UUFFRixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUEsMEJBQWdCLEVBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBQ2xELENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLHFGQUFxRixFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3JHLE1BQU0sMkJBQTJCLEdBQUcsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQy9HLE1BQU0sNkJBQTZCLEdBQUcsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLGFBQWEsRUFBRSxtQkFBbUIsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRW5ILG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxHQUFHLE1BQU0sSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRyxtQkFBbUIsQ0FBQyxpQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLDZCQUE2QixFQUFFLENBQUMsQ0FBQztRQUNySCxtQkFBbUIsQ0FBQyxpQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztRQUNuSCxtQkFBbUIsQ0FBQyxvQkFBcUIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUNuRixtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxTQUFTLEVBQUUsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakcsbUJBQW1CLENBQUMsdUJBQXdCLENBQUMsZUFBZSxDQUFDLEVBQUUsbUJBQW1CLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztRQUN0RyxtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUFDLGNBQWMsRUFBRSxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDckksbUJBQW1CLENBQUMsb0JBQXFCLENBQUMsZUFBZSxDQUFDLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFDN0YsbUJBQW1CLENBQUMsZ0NBQWlDLENBQUMsZUFBZSxDQUFDLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFL0csTUFBTSxJQUFJLEdBQUc7WUFDWCxTQUFTLEVBQUUsU0FBUztZQUNwQixPQUFPLEVBQUUsRUFBRTtZQUNYLE9BQU8sRUFBRSxJQUFJO1lBQ2IsV0FBVyxFQUFFLFdBQVc7WUFDeEIsV0FBVyxFQUFFLFdBQVc7U0FDekIsQ0FBQztRQUNGLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBQSwwQkFBZ0IsRUFBQyxJQUFJLENBQUMsQ0FBQztRQUM5QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUM7SUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsK0ZBQStGLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDL0csTUFBTSxxQkFBcUIsR0FBeUMsRUFBRSxDQUFDO1FBRXZFLG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztRQUV6RyxNQUFNLElBQUksR0FBNEI7WUFDcEMsU0FBUyxFQUFFLFNBQVM7WUFDcEIsT0FBTyxFQUFFLEVBQUU7WUFDWCxRQUFRLEVBQUUsa0JBQVEsQ0FBQyxXQUFXO1lBQzlCLFdBQVcsRUFBRSxXQUFXO1lBQ3hCLFdBQVcsRUFBRSxXQUFXO1NBQ3pCLENBQUM7UUFDRixNQUFNLE1BQU0sQ0FBQyxJQUFBLDBCQUFnQixFQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxxSEFBcUgsQ0FBQyxDQUFDO0lBQzlLLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLCtFQUErRSxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQy9GLE1BQU0scUJBQXFCLEdBQUcsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBRXpHLG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ25GLG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztRQUN6RyxtQkFBbUIsQ0FBQyxvQkFBcUIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUNuRixtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxTQUFTLEVBQUUsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakcsbUJBQW1CLENBQUMsdUJBQXdCLENBQUMsZUFBZSxDQUFDLEVBQUUsbUJBQW1CLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztRQUN0RyxtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztRQUN2RixtQkFBbUIsQ0FBQyxvQkFBcUIsQ0FBQyxlQUFlLENBQUMsRUFBRSxZQUFZLEVBQUUsZUFBZSxFQUFFLENBQUMsQ0FBQztRQUM3RixtQkFBbUIsQ0FBQyxnQ0FBaUMsQ0FBQyxlQUFlLENBQUMsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUU5RyxNQUFNLElBQUksR0FBNEI7WUFDcEMsU0FBUyxFQUFFLFNBQVM7WUFDcEIsT0FBTyxFQUFFLENBQUMsMkJBQTJCLENBQUM7WUFDdEMsUUFBUSxFQUFFLGtCQUFRLENBQUMsV0FBVztZQUM5QixXQUFXLEVBQUUsV0FBVztZQUN4QixXQUFXLEVBQUUsV0FBVztTQUN6QixDQUFDO1FBQ0YsTUFBTSxNQUFNLENBQUMsSUFBQSwwQkFBZ0IsRUFBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsNkJBQTZCLENBQUMsQ0FBQztJQUN0RixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywrRUFBK0UsRUFBRSxLQUFLLElBQUksRUFBRTtRQUMvRixNQUFNLDJCQUEyQixHQUFHLENBQUMsRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUMvRyxNQUFNLDZCQUE2QixHQUFHLENBQUMsRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsbUJBQW1CLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVuSCxtQkFBbUIsQ0FBQyxpQkFBa0IsQ0FBQyxlQUFlLENBQUMsRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNuRixtQkFBbUIsQ0FBQyxpQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDakcsbUJBQW1CLENBQUMsaUJBQWtCLENBQUMsbUJBQW1CLENBQUMsRUFBRSxxQkFBcUIsRUFBRSw2QkFBNkIsRUFBRSxDQUFDLENBQUM7UUFDckgsbUJBQW1CLENBQUMsaUJBQWtCLENBQUMsbUJBQW1CLENBQUMsRUFBRSxxQkFBcUIsRUFBRSwyQkFBMkIsRUFBRSxDQUFDLENBQUM7UUFDbkgsbUJBQW1CLENBQUMsb0JBQXFCLENBQUMsZUFBZSxDQUFDLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDbkYsbUJBQW1CLENBQUMseUJBQTBCLENBQUMsZUFBZSxDQUFDLEVBQUUsU0FBUyxFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2pHLG1CQUFtQixDQUFDLHVCQUF3QixDQUFDLGVBQWUsQ0FBQyxFQUFFLG1CQUFtQixFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUM7UUFDdEcsbUJBQW1CLENBQUMseUJBQTBCLENBQUMsZUFBZSxDQUFDLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsQ0FBQyxjQUFjLEVBQUUsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3JJLG1CQUFtQixDQUFDLG9CQUFxQixDQUFDLGVBQWUsQ0FBQyxFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsQ0FBQyxDQUFDO1FBQzdGLG1CQUFtQixDQUFDLGdDQUFpQyxDQUFDLGVBQWUsQ0FBQyxFQUFFLGdCQUFnQixFQUFFLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRTlHLE1BQU0sSUFBSSxHQUE0QjtZQUNwQyxTQUFTLEVBQUUsU0FBUztZQUNwQixXQUFXLEVBQUUsV0FBVztZQUN4QixXQUFXLEVBQUUsV0FBVztTQUN6QixDQUFDO1FBQ0YsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLDBCQUFnQixFQUFDLElBQUksQ0FBQyxDQUFDO1FBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUNoRCxNQUFNLENBQUMsbUJBQW1CLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ25FLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDZFQUE2RSxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzdGLE1BQU0scUJBQXFCLEdBQUcsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBRXpHLG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ25GLG1CQUFtQixDQUFDLGlCQUFrQixDQUFDLGVBQWUsQ0FBQyxFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztRQUN6RyxtQkFBbUIsQ0FBQyxvQkFBcUIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUNuRixtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxTQUFTLEVBQUUsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakcsbUJBQW1CLENBQUMsdUJBQXdCLENBQUMsZUFBZSxDQUFDLEVBQUUsbUJBQW1CLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztRQUN0RyxtQkFBbUIsQ0FBQyx5QkFBMEIsQ0FBQyxlQUFlLENBQUMsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUFDLGNBQWMsRUFBRSxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDckksbUJBQW1CLENBQUMsb0JBQXFCLENBQUMsZUFBZSxDQUFDLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFDN0YsbUJBQW1CLENBQUMsZ0NBQWlDLENBQUMsZUFBZSxDQUFDLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFOUcsTUFBTSxJQUFJLEdBQTRCO1lBQ3BDLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLE9BQU8sRUFBRSxDQUFDLHdEQUF3RCxFQUFFLHlCQUF5QixDQUFDO1lBQzlGLFdBQVcsRUFBRSxXQUFXO1lBQ3hCLFdBQVcsRUFBRSxXQUFXO1NBQ3pCLENBQUM7UUFDRixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUEsMEJBQWdCLEVBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBQ2xELENBQUMsQ0FBQyxDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjIGFzIF9leGVjIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgeyBDbG91ZEZvcm1hdGlvbiB9IGZyb20gJ2F3cy1zZGsnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHsgZ2VuZXJhdGVDZGtBcHAsIGdlbmVyYXRlU3RhY2ssIHJlYWRGcm9tUGF0aCwgcmVhZEZyb21TdGFjaywgc2V0RW52aXJvbm1lbnQsIHBhcnNlU291cmNlT3B0aW9ucywgZ2VuZXJhdGVUZW1wbGF0ZSwgVGVtcGxhdGVTb3VyY2VPcHRpb25zLCBHZW5lcmF0ZVRlbXBsYXRlT3B0aW9ucywgRnJvbVNjYW4gfSBmcm9tICcuLi8uLi9saWIvY29tbWFuZHMvbWlncmF0ZSc7XG5pbXBvcnQgeyBNb2NrU2RrUHJvdmlkZXIsIE1vY2tlZE9iamVjdCwgU3luY0hhbmRsZXJTdWJzZXRPZiB9IGZyb20gJy4uL3V0aWwvbW9jay1zZGsnO1xuXG5jb25zdCBleGVjID0gcHJvbWlzaWZ5KF9leGVjKTtcblxuZGVzY3JpYmUoJ01pZ3JhdGUgRnVuY3Rpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBzZGtQcm92aWRlcjogTW9ja1Nka1Byb3ZpZGVyO1xuICBsZXQgZ2V0VGVtcGxhdGVNb2NrOiBqZXN0Lk1vY2s7XG4gIGxldCBkZXNjcmliZVN0YWNrc01vY2s6IGplc3QuTW9jaztcbiAgbGV0IGNmbk1vY2tzOiBNb2NrZWRPYmplY3Q8U3luY0hhbmRsZXJTdWJzZXRPZjxBV1MuQ2xvdWRGb3JtYXRpb24+PjtcblxuICBjb25zdCB0ZXN0UmVzb3VyY2VQYXRoID0gW19fZGlybmFtZSwgJ3Rlc3QtcmVzb3VyY2VzJ107XG4gIGNvbnN0IHRlbXBsYXRlUGF0aCA9IFsuLi50ZXN0UmVzb3VyY2VQYXRoLCAndGVtcGxhdGVzJ107XG4gIGNvbnN0IHN0YWNrUGF0aCA9IFsuLi50ZXN0UmVzb3VyY2VQYXRoLCAnc3RhY2tzJ107XG5cbiAgY29uc3QgdmFsaWRUZW1wbGF0ZVBhdGggPSBwYXRoLmpvaW4oLi4udGVtcGxhdGVQYXRoLCAnczMtdGVtcGxhdGUuanNvbicpO1xuICBjb25zdCBlbXB0eVRlbXBsYXRlUGF0aCA9IHBhdGguam9pbiguLi50ZW1wbGF0ZVBhdGgsICdlbXB0eS10ZW1wbGF0ZS55bWwnKTtcbiAgY29uc3QgaW52YWxpZFRlbXBsYXRlUGF0aCA9IHBhdGguam9pbiguLi50ZW1wbGF0ZVBhdGgsICdyZHMtdGVtcGxhdGUuanNvbicpO1xuICBjb25zdCB2YWxpZFRlbXBsYXRlID0gcmVhZEZyb21QYXRoKHZhbGlkVGVtcGxhdGVQYXRoKSE7XG4gIGNvbnN0IGludmFsaWRUZW1wbGF0ZSA9IHJlYWRGcm9tUGF0aChpbnZhbGlkVGVtcGxhdGVQYXRoKSE7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgc2RrUHJvdmlkZXIgPSBuZXcgTW9ja1Nka1Byb3ZpZGVyKCk7XG4gICAgZ2V0VGVtcGxhdGVNb2NrID0gamVzdC5mbigpO1xuICAgIGRlc2NyaWJlU3RhY2tzTW9jayA9IGplc3QuZm4oKTtcbiAgICBjZm5Nb2NrcyA9IHsgZ2V0VGVtcGxhdGU6IGdldFRlbXBsYXRlTW9jaywgZGVzY3JpYmVTdGFja3M6IGRlc2NyaWJlU3RhY2tzTW9jayB9O1xuICAgIHNka1Byb3ZpZGVyLnN0dWJDbG91ZEZvcm1hdGlvbihjZm5Nb2NrcyBhcyBhbnkpO1xuICB9KTtcblxuICB0ZXN0KCdwYXJzZVNvdXJjZU9wdGlvbnMgdGhyb3dzIGlmIGJvdGggLS1mcm9tLXBhdGggYW5kIC0tZnJvbS1zdGFjayBpcyBwcm92aWRlZCcsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4gcGFyc2VTb3VyY2VPcHRpb25zKCdhbnktdmFsdWUnLCB0cnVlLCAnbXktYXdlc29tZS1zdGFjaycpKS50b1Rocm93RXJyb3IoJ09ubHkgb25lIG9mIGAtLWZyb20tcGF0aGAgb3IgYC0tZnJvbS1zdGFja2AgbWF5IGJlIHByb3ZpZGVkLicpO1xuICB9KTtcblxuICB0ZXN0KCdwYXJzZVNvdXJjZU9wdGlvbnMgcmV0dXJucyBmcm9tLXNjYW4gd2hlbiBuZWl0aGVyIC0tZnJvbS1wYXRoIG9yIC0tZnJvbS1zdGFjayBhcmUgcHJvdmlkZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHBhcnNlU291cmNlT3B0aW9ucyh1bmRlZmluZWQsIHVuZGVmaW5lZCwgJ215LXN0YWNrLW5hbWUnKSkudG9TdHJpY3RFcXVhbCh7IHNvdXJjZTogVGVtcGxhdGVTb3VyY2VPcHRpb25zLlNDQU4gfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3BhcnNlU291cmNlT3B0aW9ucyBkb2VzIG5vdCB0aHJvdyB3aGVuIG9ubHkgLS1mcm9tLXBhdGggaXMgc3VwcGxpZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHBhcnNlU291cmNlT3B0aW9ucygnbXktZmlsZS1wYXRoJywgdW5kZWZpbmVkLCAnbXktc3RhY2stbmFtZScpKS50b1N0cmljdEVxdWFsKHsgc291cmNlOiBUZW1wbGF0ZVNvdXJjZU9wdGlvbnMuUEFUSCwgdGVtcGxhdGVQYXRoOiAnbXktZmlsZS1wYXRoJyB9KTtcbiAgfSk7XG5cbiAgdGVzdCgncGFyc2VTb3VyY2VPcHRpb25zIGRvZXMgbm93IHRocm93IHdoZW4gb25seSAtLWZyb20tc3RhY2sgaXMgcHJvdmlkZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHBhcnNlU291cmNlT3B0aW9ucyh1bmRlZmluZWQsIHRydWUsICdteS1zdGFjay1uYW1lJykpLnRvU3RyaWN0RXF1YWwoeyBzb3VyY2U6IFRlbXBsYXRlU291cmNlT3B0aW9ucy5TVEFDSywgc3RhY2tOYW1lOiAnbXktc3RhY2stbmFtZScgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlYWRGcm9tUGF0aCBwcm9kdWNlcyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGVtcGxhdGUgYXQgYSBnaXZlbiBwYXRoJywgKCkgPT4ge1xuICAgIGV4cGVjdChyZWFkRnJvbVBhdGgodmFsaWRUZW1wbGF0ZVBhdGgpKS50b0VxdWFsKGZzLnJlYWRGaWxlU3luYyh2YWxpZFRlbXBsYXRlUGF0aCwgJ3V0ZjgnKSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlYWRGcm9tUGF0aCB0aHJvd3MgZXJyb3Igd2hlbiB0ZW1wbGF0ZSBmaWxlIGlzIGVtcHR5JywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiByZWFkRnJvbVBhdGgoZW1wdHlUZW1wbGF0ZVBhdGgpKS50b1Rocm93KGBcXCcke2VtcHR5VGVtcGxhdGVQYXRofVxcJyBpcyBhbiBlbXB0eSBmaWxlLmApO1xuICB9KTtcblxuICB0ZXN0KCdyZWFkRnJvbVBhdGggdGhyb3dzIGVycm9yIHdoZW4gdGVtcGxhdGUgZmlsZSBkb2VzIG5vdCBleGlzdCBhdCBhIGdpdmVuIHBhdGgnLCAoKSA9PiB7XG4gICAgY29uc3QgYmFkVGVtcGxhdGVQYXRoID0gJy4vbm90LWhlcmUuanNvbic7XG4gICAgZXhwZWN0KCgpID0+IHJlYWRGcm9tUGF0aChiYWRUZW1wbGF0ZVBhdGgpKS50b1Rocm93RXJyb3IoYFxcJyR7YmFkVGVtcGxhdGVQYXRofVxcJyBpcyBub3QgYSB2YWxpZCBwYXRoLmApO1xuICB9KTtcblxuICB0ZXN0KCdyZWFkRnJvbVN0YWNrIHByb2R1Y2VzIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB0ZW1wbGF0ZSByZXRyaWV2ZWQgZnJvbSBDbG91ZEZvcm1hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGZzLnJlYWRGaWxlU3luYyh2YWxpZFRlbXBsYXRlUGF0aCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9KTtcbiAgICBnZXRUZW1wbGF0ZU1vY2subW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XG4gICAgICBUZW1wbGF0ZUJvZHk6IHRlbXBsYXRlLFxuICAgIH0pKTtcblxuICAgIGRlc2NyaWJlU3RhY2tzTW9jay5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgICAgIFN0YWNrczogW1xuICAgICAgICB7XG4gICAgICAgICAgU3RhY2tOYW1lOiAndGhpcy1vbmUnLFxuICAgICAgICAgIFN0YWNrU3RhdHVzOiAnQ1JFQVRFX0NPTVBMRVRFJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkpO1xuXG4gICAgZXhwZWN0KGF3YWl0IHJlYWRGcm9tU3RhY2soJ3RoaXMtb25lJywgc2RrUHJvdmlkZXIsIHsgYWNjb3VudDogJ251bScsIHJlZ2lvbjogJ2hlcmUnLCBuYW1lOiAnaGVsbG8tbXktbmFtZS1pcy13aGF0Li4uJyB9KSkudG9FcXVhbChKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKHRlbXBsYXRlKSkpO1xuICB9KTtcblxuICB0ZXN0KCdyZWFkRnJvbVN0YWNrIHRocm93cyBlcnJvciB3aGVuIG5vIHN0YWNrIGV4aXN0cyB3aXRoIHRoZSBzdGFjayBuYW1lIGluIHRoZSBhY2NvdW50IGFuZCByZWdpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgZGVzY3JpYmVTdGFja3NNb2NrLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7IHRocm93IG5ldyBFcnJvcignTm8gc3RhY2suIFRoaXMgZGlkIG5vdCBnbyB3ZWxsLicpOyB9KTtcbiAgICBhd2FpdCBleHBlY3QoKCkgPT4gcmVhZEZyb21TdGFjaygndGhhdC1vbmUnLCBzZGtQcm92aWRlciwgeyBhY2NvdW50OiAnbnVtJywgcmVnaW9uOiAnaGVyZScsIG5hbWU6ICdoZWxsby1teS1uYW1lLWlzLXdoby4uLicgfSkpLnJlamVjdHMudG9UaHJvdygnTm8gc3RhY2suIFRoaXMgZGlkIG5vdCBnbyB3ZWxsLicpO1xuICB9KTtcblxuICB0ZXN0KCdyZWFkRnJvbVN0YWNrIHRocm93cyBlcnJvciB3aGVuIHN0YWNrIGV4aXN0cyBidXQgdGhlIHN0YXR1cyBpcyBub3QgaGVhbHRoeScsIGFzeW5jICgpID0+IHtcbiAgICBkZXNjcmliZVN0YWNrc01vY2subW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XG4gICAgICBTdGFja3M6IFtcbiAgICAgICAge1xuICAgICAgICAgIFN0YWNrTmFtZTogJ3RoaXMtb25lJyxcbiAgICAgICAgICBTdGFja1N0YXR1czogJ0NSRUFURV9GQUlMRUQnLFxuICAgICAgICAgIFN0YWNrU3RhdHVzUmVhc29uOiAnU29tZXRoaW5nIHdlbnQgd3JvbmcnLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KSk7XG5cbiAgICBhd2FpdCBleHBlY3QoKCkgPT4gcmVhZEZyb21TdGFjaygndGhhdC1vbmUnLCBzZGtQcm92aWRlciwgeyBhY2NvdW50OiAnbnVtJywgcmVnaW9uOiAnaGVyZScsIG5hbWU6ICdoZWxsby1teS1uYW1lLWlzLWNoaWNrYS1jaGlja2EuLi4nIH0pKS5yZWplY3RzLnRvVGhyb3coJ1N0YWNrIFxcJ3RoYXQtb25lXFwnIGluIGFjY291bnQgbnVtIGFuZCByZWdpb24gaGVyZSBoYXMgYSBzdGF0dXMgb2YgXFwnQ1JFQVRFX0ZBSUxFRFxcJyBkdWUgdG8gXFwnU29tZXRoaW5nIHdlbnQgd3JvbmdcXCcuIFRoZSBzdGFjayBjYW5ub3QgYmUgbWlncmF0ZWQgdW50aWwgaXQgaXMgaW4gYSBoZWFsdGh5IHN0YXRlLicpO1xuICB9KTtcblxuICB0ZXN0KCdzZXRFbnZpcm9ubWVudCBzZXRzIGFjY291bnQgYW5kIHJlZ2lvbiB3aGVuIHByb3ZpZGVkJywgKCkgPT4ge1xuICAgIGV4cGVjdChzZXRFbnZpcm9ubWVudCgnbXktYWNjb3VudCcsICdzb21ld2hlcmUnKSkudG9FcXVhbCh7IGFjY291bnQ6ICdteS1hY2NvdW50JywgcmVnaW9uOiAnc29tZXdoZXJlJywgbmFtZTogJ2Nkay1taWdyYXRlLWVudicgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3NlckVudmlyb25tZW50IHVzZXMgZGVmYXVsdCBhY2NvdW50IGFuZCByZWdpb24gd2hlbiBub3QgcHJvdmlkZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHNldEVudmlyb25tZW50KCkpLnRvRXF1YWwoeyBhY2NvdW50OiAndW5rbm93bi1hY2NvdW50JywgcmVnaW9uOiAndW5rbm93bi1yZWdpb24nLCBuYW1lOiAnY2RrLW1pZ3JhdGUtZW52JyB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVTdGFjayBnZW5lcmF0ZXMgdGhlIGV4cGVjdGVkIHN0YWNrIHN0cmluZyB3aGVuIGNhbGxlZCBmb3IgdHlwZXNjcmlwdCcsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RUeXBlU2NyaXB0JywgJ3R5cGVzY3JpcHQnKTtcbiAgICBleHBlY3Qoc3RhY2spLnRvRXF1YWwoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbiguLi5zdGFja1BhdGgsICdzMy1zdGFjay50cycpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVTdGFjayBnZW5lcmF0ZXMgdGhlIGV4cGVjdGVkIHN0YWNrIHN0cmluZyB3aGVuIGNhbGxlZCBmb3IgcHl0aG9uJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gZ2VuZXJhdGVTdGFjayh2YWxpZFRlbXBsYXRlLCAnR29vZFB5dGhvbicsICdweXRob24nKTtcbiAgICBleHBlY3Qoc3RhY2spLnRvRXF1YWwoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbiguLi5zdGFja1BhdGgsICdzM19zdGFjay5weScpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVTdGFjayBnZW5lcmF0ZXMgdGhlIGV4cGVjdGVkIHN0YWNrIHN0cmluZyB3aGVuIGNhbGxlZCBmb3IgamF2YScsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RKYXZhJywgJ2phdmEnKTtcbiAgICBleHBlY3Qoc3RhY2spLnRvRXF1YWwoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbiguLi5zdGFja1BhdGgsICdTM1N0YWNrLmphdmEnKSwgJ3V0ZjgnKSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2dlbmVyYXRlU3RhY2sgZ2VuZXJhdGVzIHRoZSBleHBlY3RlZCBzdGFjayBzdHJpbmcgd2hlbiBjYWxsZWQgZm9yIGNzaGFycCcsICgpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RDU2hhcnAnLCAnY3NoYXJwJyk7XG4gICAgZXhwZWN0KHN0YWNrKS50b0VxdWFsKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oLi4uc3RhY2tQYXRoLCAnUzNTdGFjay5jcycpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgLy8gVE9ETzogZml4IHdpdGggYWN0dWFsIGdvIHRlbXBsYXRlXG4gIHRlc3QoJ2dlbmVyYXRlU3RhY2sgZ2VuZXJhdGVzIHRoZSBleHBlY3RlZCBzdGFjayBzdHJpbmcgd2hlbiBjYWxsZWQgZm9yIGdvJywgKCkgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gZ2VuZXJhdGVTdGFjayh2YWxpZFRlbXBsYXRlLCAnR29vZEdvJywgJ2dvJyk7XG4gICAgZXhwZWN0KHN0YWNrKS50b0VxdWFsKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oLi4uc3RhY2tQYXRoLCAnczMuZ28nKSwgJ3V0ZjgnKSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2dlbmVyYXRlU3RhY2sgdGhyb3dzIGVycm9yIHdoZW4gY2FsbGVkIGZvciBvdGhlciBsYW5ndWFnZScsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4gZ2VuZXJhdGVTdGFjayh2YWxpZFRlbXBsYXRlLCAnQmFkQmFkQmFkJywgJ3BocCcpKS50b1Rocm93RXJyb3IoJ0JhZEJhZEJhZFN0YWNrIGNvdWxkIG5vdCBiZSBnZW5lcmF0ZWQgYmVjYXVzZSBwaHAgaXMgbm90IGEgc3VwcG9ydGVkIGxhbmd1YWdlJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2dlbmVyYXRlU3RhY2sgdGhyb3dzIGVycm9yIGZvciBpbnZhbGlkIHJlc291cmNlIHByb3BlcnR5JywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiBnZW5lcmF0ZVN0YWNrKGludmFsaWRUZW1wbGF0ZSwgJ1ZlcnlCYWQnLCAndHlwZXNjcmlwdCcpKS50b1Rocm93KCdWZXJ5QmFkU3RhY2sgY291bGQgbm90IGJlIGdlbmVyYXRlZCBiZWNhdXNlIFJlYWRFbmRwb2ludCBpcyBub3QgYSB2YWxpZCBwcm9wZXJ0eSBmb3IgcmVzb3VyY2UgUkRTQ2x1c3RlciBvZiB0eXBlIEFXUzo6UkRTOjpEQkNsdXN0ZXInKTtcbiAgfSk7XG5cbiAgY2xpVGVzdCgnZ2VuZXJhdGVDZGtBcHAgZ2VuZXJhdGVzIHRoZSBleHBlY3RlZCBjZGsgYXBwIHdoZW4gY2FsbGVkIGZvciB0eXBlc2NyaXB0JywgYXN5bmMgKHdvcmtEaXIpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RUeXBlU2NyaXB0JywgJ3R5cGVzY3JpcHQnKTtcbiAgICBhd2FpdCBnZW5lcmF0ZUNka0FwcCgnR29vZFR5cGVTY3JpcHQnLCBzdGFjaywgJ3R5cGVzY3JpcHQnLCB3b3JrRGlyKTtcblxuICAgIC8vIFBhY2thZ2VzIGV4aXN0IGluIHRoZSBjb3JyZWN0IHNwb3RcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kVHlwZVNjcmlwdCcsICdwYWNrYWdlLmpzb24nKSkpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kVHlwZVNjcmlwdCcsICdiaW4nLCAnZ29vZF90eXBlX3NjcmlwdC50cycpKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChmcy5wYXRoRXhpc3RzU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RUeXBlU2NyaXB0JywgJ2xpYicsICdnb29kX3R5cGVfc2NyaXB0LXN0YWNrLnRzJykpKS50b0JlVHJ1dGh5KCk7XG5cbiAgICAvLyBSZXBsYWNlZCBzdGFjayBmaWxlIGlzIHJlZmVyZW5jZWQgY29ycmVjdGx5IGluIGFwcCBmaWxlXG4gICAgY29uc3QgYXBwID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQnLCAnYmluJywgJ2dvb2RfdHlwZV9zY3JpcHQudHMnKSwgJ3V0ZjgnKS5zcGxpdCgnXFxuJyk7XG4gICAgZXhwZWN0KGFwcC5tYXAobGluZSA9PiBsaW5lLm1hdGNoKCdpbXBvcnQgeyBHb29kVHlwZVNjcmlwdFN0YWNrIH0gZnJvbSBcXCcuLi9saWIvZ29vZF90eXBlX3NjcmlwdC1zdGFja1xcJzsnKSkuZmlsdGVyKGxpbmUgPT4gbGluZSkubGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgIGV4cGVjdChhcHAubWFwKGxpbmUgPT4gbGluZS5tYXRjaCgvbmV3IEdvb2RUeXBlU2NyaXB0U3RhY2tcXChhcHAsIFxcJ0dvb2RUeXBlU2NyaXB0XFwnLCBcXHsvKSkuZmlsdGVyKGxpbmUgPT4gbGluZSkubGVuZ3RoKS50b0VxdWFsKDEpO1xuXG4gICAgLy8gUmVwbGFjZWQgc3RhY2sgZmlsZSBpcyBjb3JyZWN0bHkgZ2VuZXJhdGVkXG4gICAgY29uc3QgcmVwbGFjZWRTdGFjayA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RUeXBlU2NyaXB0JywgJ2xpYicsICdnb29kX3R5cGVfc2NyaXB0LXN0YWNrLnRzJyksICd1dGY4Jyk7XG4gICAgZXhwZWN0KHJlcGxhY2VkU3RhY2spLnRvRXF1YWwoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbiguLi5zdGFja1BhdGgsICdzMy1zdGFjay50cycpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgY2xpVGVzdCgnZ2VuZXJhdGVDZGtBcHAgYWRkcyBjZGstbWlncmF0ZSBrZXkgaW4gY29udGV4dCcsIGFzeW5jICh3b3JrRGlyKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBnZW5lcmF0ZVN0YWNrKHZhbGlkVGVtcGxhdGUsICdHb29kVHlwZVNjcmlwdCcsICd0eXBlc2NyaXB0Jyk7XG4gICAgYXdhaXQgZ2VuZXJhdGVDZGtBcHAoJ0dvb2RUeXBlU2NyaXB0Jywgc3RhY2ssICd0eXBlc2NyaXB0Jywgd29ya0Rpcik7XG5cbiAgICAvLyBjZGsuanNvbiBleGlzdCBpbiB0aGUgY29ycmVjdCBzcG90XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQnLCAnY2RrLmpzb24nKSkpLnRvQmVUcnV0aHkoKTtcblxuICAgIC8vIGNkay5qc29uIGhhcyBcImNkay1taWdyYXRlXCIgOiB0cnVlIGluIGNvbnRleHRcbiAgICBjb25zdCBjZGtKc29uID0gZnMucmVhZEpzb25TeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQnLCAnY2RrLmpzb24nKSwgJ3V0ZjgnKTtcbiAgICBleHBlY3QoY2RrSnNvbi5jb250ZXh0WydjZGstbWlncmF0ZSddKS50b0JlVHJ1dGh5KCk7XG4gIH0pO1xuXG4gIGNsaVRlc3QoJ2dlbmVyYXRlQ2RrQXBwIGdlbmVyYXRlcyB0aGUgZXhwZWN0ZWQgY2RrIGFwcCB3aGVuIGNhbGxlZCBmb3IgcHl0aG9uJywgYXN5bmMgKHdvcmtEaXIpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RQeXRob24nLCAncHl0aG9uJyk7XG4gICAgYXdhaXQgZ2VuZXJhdGVDZGtBcHAoJ0dvb2RQeXRob24nLCBzdGFjaywgJ3B5dGhvbicsIHdvcmtEaXIpO1xuXG4gICAgLy8gUGFja2FnZXMgZXhpc3QgaW4gdGhlIGNvcnJlY3Qgc3BvdFxuICAgIGV4cGVjdChmcy5wYXRoRXhpc3RzU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RQeXRob24nLCAncmVxdWlyZW1lbnRzLnR4dCcpKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChmcy5wYXRoRXhpc3RzU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RQeXRob24nLCAnYXBwLnB5JykpKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFB5dGhvbicsICdnb29kX3B5dGhvbicsICdnb29kX3B5dGhvbl9zdGFjay5weScpKSkudG9CZVRydXRoeSgpO1xuXG4gICAgLy8gUmVwbGFjZWQgc3RhY2sgZmlsZSBpcyByZWZlcmVuY2VkIGNvcnJlY3RseSBpbiBhcHAgZmlsZVxuICAgIGNvbnN0IGFwcCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RQeXRob24nLCAnYXBwLnB5JyksICd1dGY4Jykuc3BsaXQoJ1xcbicpO1xuICAgIGV4cGVjdChhcHAubWFwKGxpbmUgPT4gbGluZS5tYXRjaCgnZnJvbSBnb29kX3B5dGhvbi5nb29kX3B5dGhvbl9zdGFjayBpbXBvcnQgR29vZFB5dGhvblN0YWNrJykpLmZpbHRlcihsaW5lID0+IGxpbmUpLmxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICBleHBlY3QoYXBwLm1hcChsaW5lID0+IGxpbmUubWF0Y2goL0dvb2RQeXRob25TdGFja1xcKGFwcCwgXCJHb29kUHl0aG9uXCIsLykpLmZpbHRlcihsaW5lID0+IGxpbmUpLmxlbmd0aCkudG9FcXVhbCgxKTtcblxuICAgIC8vIFJlcGxhY2VkIHN0YWNrIGZpbGUgaXMgY29ycmVjdGx5IGdlbmVyYXRlZFxuICAgIGNvbnN0IHJlcGxhY2VkU3RhY2sgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kUHl0aG9uJywgJ2dvb2RfcHl0aG9uJywgJ2dvb2RfcHl0aG9uX3N0YWNrLnB5JyksICd1dGY4Jyk7XG4gICAgZXhwZWN0KHJlcGxhY2VkU3RhY2spLnRvRXF1YWwoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbiguLi5zdGFja1BhdGgsICdzM19zdGFjay5weScpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgY2xpVGVzdCgnZ2VuZXJhdGVDZGtBcHAgZ2VuZXJhdGVzIHRoZSBleHBlY3RlZCBjZGsgYXBwIHdoZW4gY2FsbGVkIGZvciBqYXZhJywgYXN5bmMgKHdvcmtEaXIpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RKYXZhJywgJ2phdmEnKTtcbiAgICBhd2FpdCBnZW5lcmF0ZUNka0FwcCgnR29vZEphdmEnLCBzdGFjaywgJ2phdmEnLCB3b3JrRGlyKTtcblxuICAgIC8vIFBhY2thZ2VzIGV4aXN0IGluIHRoZSBjb3JyZWN0IHNwb3RcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kSmF2YScsICdwb20ueG1sJykpKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZEphdmEnLCAnc3JjJywgJ21haW4nLCAnamF2YScsICdjb20nLCAnbXlvcmcnLCAnR29vZEphdmFBcHAuamF2YScpKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChmcy5wYXRoRXhpc3RzU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RKYXZhJywgJ3NyYycsICdtYWluJywgJ2phdmEnLCAnY29tJywgJ215b3JnJywgJ0dvb2RKYXZhU3RhY2suamF2YScpKSkudG9CZVRydXRoeSgpO1xuXG4gICAgLy8gUmVwbGFjZWQgc3RhY2sgZmlsZSBpcyByZWZlcmVuY2VkIGNvcnJlY3RseSBpbiBhcHAgZmlsZVxuICAgIGNvbnN0IGFwcCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RKYXZhJywgJ3NyYycsICdtYWluJywgJ2phdmEnLCAnY29tJywgJ215b3JnJywgJ0dvb2RKYXZhQXBwLmphdmEnKSwgJ3V0ZjgnKS5zcGxpdCgnXFxuJyk7XG4gICAgZXhwZWN0KGFwcC5tYXAobGluZSA9PiBsaW5lLm1hdGNoKCdwdWJsaWMgY2xhc3MgR29vZEphdmFBcHAgeycpKS5maWx0ZXIobGluZSA9PiBsaW5lKS5sZW5ndGgpLnRvRXF1YWwoMSk7XG4gICAgZXhwZWN0KGFwcC5tYXAobGluZSA9PiBsaW5lLm1hdGNoKC8gICAgICAgIG5ldyBHb29kSmF2YVN0YWNrXFwoYXBwLCBcIkdvb2RKYXZhXCIsIFN0YWNrUHJvcHMuYnVpbGRlcigpLykpLmZpbHRlcihsaW5lID0+IGxpbmUpLmxlbmd0aCkudG9FcXVhbCgxKTtcblxuICAgIC8vIFJlcGxhY2VkIHN0YWNrIGZpbGUgaXMgY29ycmVjdGx5IGdlbmVyYXRlZFxuICAgIGNvbnN0IHJlcGxhY2VkU3RhY2sgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kSmF2YScsICdzcmMnLCAnbWFpbicsICdqYXZhJywgJ2NvbScsICdteW9yZycsICdHb29kSmF2YVN0YWNrLmphdmEnKSwgJ3V0ZjgnKTtcbiAgICBleHBlY3QocmVwbGFjZWRTdGFjaykudG9FcXVhbChmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKC4uLnN0YWNrUGF0aCwgJ1MzU3RhY2suamF2YScpLCAndXRmOCcpKTtcbiAgfSk7XG5cbiAgY2xpVGVzdCgnZ2VuZXJhdGVDZGtBcHAgZ2VuZXJhdGVzIHRoZSBleHBlY3RlZCBjZGsgYXBwIHdoZW4gY2FsbGVkIGZvciBjc2hhcnAnLCBhc3luYyAod29ya0RpcikgPT4ge1xuICAgIGNvbnN0IHN0YWNrID0gZ2VuZXJhdGVTdGFjayh2YWxpZFRlbXBsYXRlLCAnR29vZENTaGFycCcsICdjc2hhcnAnKTtcbiAgICBhd2FpdCBnZW5lcmF0ZUNka0FwcCgnR29vZENTaGFycCcsIHN0YWNrLCAnY3NoYXJwJywgd29ya0Rpcik7XG5cbiAgICAvLyBQYWNrYWdlcyBleGlzdCBpbiB0aGUgY29ycmVjdCBzcG90XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZENTaGFycCcsICdzcmMnLCAnR29vZENTaGFycC5zbG4nKSkpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kQ1NoYXJwJywgJ3NyYycsICdHb29kQ1NoYXJwJywgJ1Byb2dyYW0uY3MnKSkpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kQ1NoYXJwJywgJ3NyYycsICdHb29kQ1NoYXJwJywgJ0dvb2RDU2hhcnBTdGFjay5jcycpKSkudG9CZVRydXRoeSgpO1xuXG4gICAgLy8gUmVwbGFjZWQgc3RhY2sgZmlsZSBpcyByZWZlcmVuY2VkIGNvcnJlY3RseSBpbiBhcHAgZmlsZVxuICAgIGNvbnN0IGFwcCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4od29ya0RpciwgJ0dvb2RDU2hhcnAnLCAnc3JjJywgJ0dvb2RDU2hhcnAnLCAnUHJvZ3JhbS5jcycpLCAndXRmOCcpLnNwbGl0KCdcXG4nKTtcbiAgICBleHBlY3QoYXBwLm1hcChsaW5lID0+IGxpbmUubWF0Y2goJ25hbWVzcGFjZSBHb29kQ1NoYXJwJykpLmZpbHRlcihsaW5lID0+IGxpbmUpLmxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICBleHBlY3QoYXBwLm1hcChsaW5lID0+IGxpbmUubWF0Y2goLyAgICAgICAgbmV3IEdvb2RDU2hhcnBTdGFja1xcKGFwcCwgXCJHb29kQ1NoYXJwXCIsIG5ldyBHb29kQ1NoYXJwU3RhY2tQcm9wcy8pKS5maWx0ZXIobGluZSA9PiBsaW5lKS5sZW5ndGgpLnRvRXF1YWwoMSk7XG5cbiAgICAvLyBSZXBsYWNlZCBzdGFjayBmaWxlIGlzIGNvcnJlY3RseSBnZW5lcmF0ZWRcbiAgICBjb25zdCByZXBsYWNlZFN0YWNrID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZENTaGFycCcsICdzcmMnLCAnR29vZENTaGFycCcsICdHb29kQ1NoYXJwU3RhY2suY3MnKSwgJ3V0ZjgnKTtcbiAgICBleHBlY3QocmVwbGFjZWRTdGFjaykudG9FcXVhbChmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKC4uLnN0YWNrUGF0aCwgJ1MzU3RhY2suY3MnKSwgJ3V0ZjgnKSk7XG4gIH0pO1xuXG4gIGNsaVRlc3QoJ2dlbmVyYXRlZENka0FwcCBnZW5lcmF0ZXMgdGhlIGV4cGVjdGVkIGNkayBhcHAgd2hlbiBjYWxsZWQgZm9yIGdvJywgYXN5bmMgKHdvcmtEaXIpID0+IHtcbiAgICBjb25zdCBzdGFjayA9IGdlbmVyYXRlU3RhY2sodmFsaWRUZW1wbGF0ZSwgJ0dvb2RHbycsICdnbycpO1xuICAgIGF3YWl0IGdlbmVyYXRlQ2RrQXBwKCdHb29kR28nLCBzdGFjaywgJ2dvJywgd29ya0Rpcik7XG5cbiAgICBleHBlY3QoZnMucGF0aEV4aXN0cyhwYXRoLmpvaW4od29ya0RpciwgJ3MzLmdvJykpKS50b0JlVHJ1dGh5KCk7XG4gICAgY29uc3QgYXBwID0gZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZEdvJywgJ2dvb2RfZ28uZ28nKSwgJ3V0ZjgnKS5zcGxpdCgnXFxuJyk7XG4gICAgZXhwZWN0KGFwcC5tYXAobGluZSA9PiBsaW5lLm1hdGNoKC9mdW5jIE5ld0dvb2RHb1N0YWNrXFwoc2NvcGUgY29uc3RydWN0cy5Db25zdHJ1Y3QsIGlkIHN0cmluZywgcHJvcHMgXFwqR29vZEdvU3RhY2tQcm9wc1xcKSBcXCpHb29kR29TdGFjayBcXHsvKSkuZmlsdGVyKGxpbmUgPT4gbGluZSkubGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgIGV4cGVjdChhcHAubWFwKGxpbmUgPT4gbGluZS5tYXRjaCgvICAgIE5ld0dvb2RHb1N0YWNrXFwoYXBwLCBcIkdvb2RHb1wiLCAmR29vZEdvU3RhY2tQcm9wc1xcey8pKSk7XG4gIH0pO1xuXG4gIGNsaVRlc3QoJ2dlbmVyYXRlZENka0FwcCBnZW5lcmF0ZXMgYSB6aXAgZmlsZSB3aGVuIC0tY29tcHJlc3MgaXMgdXNlZCcsIGFzeW5jICh3b3JrRGlyKSA9PiB7XG4gICAgY29uc3Qgc3RhY2sgPSBnZW5lcmF0ZVN0YWNrKHZhbGlkVGVtcGxhdGUsICdHb29kVHlwZVNjcmlwdCcsICd0eXBlc2NyaXB0Jyk7XG4gICAgYXdhaXQgZ2VuZXJhdGVDZGtBcHAoJ0dvb2RUeXBlU2NyaXB0Jywgc3RhY2ssICd0eXBlc2NyaXB0Jywgd29ya0RpciwgdHJ1ZSk7XG5cbiAgICAvLyBQYWNrYWdlcyBub3QgaW4gb3V0RGlyXG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQnLCAncGFja2FnZS5qc29uJykpKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdHb29kVHlwZVNjcmlwdCcsICdiaW4nLCAnZ29vZF90eXBlX3NjcmlwdC50cycpKSkudG9CZUZhbHN5KCk7XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQnLCAnbGliJywgJ2dvb2RfdHlwZV9zY3JpcHQtc3RhY2sudHMnKSkpLnRvQmVGYWxzeSgpO1xuXG4gICAgLy8gWmlwIGZpbGUgZXhpc3RzXG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnR29vZFR5cGVTY3JpcHQuemlwJykpKS50b0JlVHJ1dGh5KCk7XG5cbiAgICAvLyBVbnppcCBpdFxuICAgIGF3YWl0IGV4ZWMoYHVuemlwICR7cGF0aC5qb2luKHdvcmtEaXIsICdHb29kVHlwZVNjcmlwdC56aXAnKX1gLCB7IGN3ZDogd29ya0RpciB9KTtcblxuICAgIC8vIE5vdyB0aGUgZmlsZXMgc2hvdWxkIGJlIHRoZXJlXG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAncGFja2FnZS5qc29uJykpKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGZzLnBhdGhFeGlzdHNTeW5jKHBhdGguam9pbih3b3JrRGlyLCAnYmluJywgJ2dvb2RfdHlwZV9zY3JpcHQudHMnKSkpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QoZnMucGF0aEV4aXN0c1N5bmMocGF0aC5qb2luKHdvcmtEaXIsICdsaWInLCAnZ29vZF90eXBlX3NjcmlwdC1zdGFjay50cycpKSkudG9CZVRydXRoeSgpO1xuICB9KTtcbn0pO1xuXG5mdW5jdGlvbiBjbGlUZXN0KG5hbWU6IHN0cmluZywgaGFuZGxlcjogKGRpcjogc3RyaW5nKSA9PiB2b2lkIHwgUHJvbWlzZTxhbnk+KTogdm9pZCB7XG4gIHRlc3QobmFtZSwgKCkgPT4gd2l0aFRlbXBEaXIoaGFuZGxlcikpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB3aXRoVGVtcERpcihjYjogKGRpcjogc3RyaW5nKSA9PiB2b2lkIHwgUHJvbWlzZTxhbnk+KSB7XG4gIGNvbnN0IHRtcERpciA9IGF3YWl0IGZzLm1rZHRlbXAocGF0aC5qb2luKG9zLnRtcGRpcigpLCAnYXdzLWNkay10ZXN0JykpO1xuICB0cnkge1xuICAgIGF3YWl0IGNiKHRtcERpcik7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZnMucmVtb3ZlKHRtcERpcik7XG4gIH1cbn1cblxuZGVzY3JpYmUoJ2dlbmVyYXRlVGVtcGxhdGUnLCAoKSA9PiB7XG4gIGxldCBzZGtQcm92aWRlcjogTW9ja1Nka1Byb3ZpZGVyO1xuICBsZXQgY2xvdWRGb3JtYXRpb25Nb2NrczogTW9ja2VkT2JqZWN0PFN5bmNIYW5kbGVyU3Vic2V0T2Y8QVdTLkNsb3VkRm9ybWF0aW9uPj47XG4gIGNvbnN0IHNhbXBsZVJlc291cmNlID0ge1xuICAgIFJlc291cmNlVHlwZTogJ0FXUzo6UzM6OkJ1Y2tldCcsXG4gICAgTWFuYWdlZEJ5U3RhY2s6IHRydWUsXG4gICAgUmVzb3VyY2VJZGVudGlmaWVyOiB7ICdteS1rZXknOiAnbXktYnVja2V0JyB9LFxuICAgIExvZ2ljYWxSZXNvdXJjZUlkOiAnbXktYnVja2V0JyxcbiAgfTtcbiAgY29uc3Qgc2FtcGxlUmVzb3VyY2UyID0ge1xuICAgIFJlc291cmNlVHlwZTogJ0FXUzo6RUMyOjpJbnN0YW5jZScsXG4gICAgUmVzb3VyY2VJZGVudGlmaWVyOiB7XG4gICAgICBpbnN0YW5jZUlkOiAnaS0xMjM0NTY3ODkwYWJjZGVmMCcsXG4gICAgfSxcbiAgICBMb2dpY2FsUmVzb3VyY2VJZDogJ215LWVjMi1pbnN0YW5jZScsXG4gICAgTWFuYWdlZEJ5U3RhY2s6IHRydWUsXG4gIH07XG4gIGNvbnN0IHN0YWNrTmFtZSA9ICdteS1zdGFjayc7XG4gIGNvbnN0IGVudmlyb25tZW50ID0gc2V0RW52aXJvbm1lbnQoJzEyMzQ1Njc4OTAxMicsICd1cy1lYXN0LTEnKTtcbiAgY29uc3Qgc2NhbklkID0gJ2Zha2Utc2Nhbi1pZCc7XG4gIGNvbnN0IGRlZmF1bHRFeHBlY3RlZFJlc3VsdCA9IHtcbiAgICBtaWdyYXRlSnNvbjoge1xuICAgICAgcmVzb3VyY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBMb2dpY2FsUmVzb3VyY2VJZDogJ215LWJ1Y2tldCcsXG4gICAgICAgICAgUmVzb3VyY2VJZGVudGlmaWVyOiB7ICdteS1rZXknOiAnbXktYnVja2V0JyB9LFxuICAgICAgICAgIFJlc291cmNlVHlwZTogJ0FXUzo6UzM6OkJ1Y2tldCcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBMb2dpY2FsUmVzb3VyY2VJZDogJ215LWVjMi1pbnN0YW5jZScsXG4gICAgICAgICAgUmVzb3VyY2VJZGVudGlmaWVyOiB7IGluc3RhbmNlSWQ6ICdpLTEyMzQ1Njc4OTBhYmNkZWYwJyB9LFxuICAgICAgICAgIFJlc291cmNlVHlwZTogJ0FXUzo6RUMyOjpJbnN0YW5jZScsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgc291cmNlOiAndGVtcGxhdGUtYXJuJyxcbiAgICAgIHRlbXBsYXRlQm9keTogJ3RlbXBsYXRlLWJvZHknLFxuICAgIH0sXG4gICAgcmVzb3VyY2VzOiBbXG4gICAgICB7XG4gICAgICAgIExvZ2ljYWxSZXNvdXJjZUlkOiAnbXktYnVja2V0JyxcbiAgICAgICAgTWFuYWdlZEJ5U3RhY2s6IHRydWUsXG4gICAgICAgIFJlc291cmNlSWRlbnRpZmllcjoge1xuICAgICAgICAgICdteS1rZXknOiAnbXktYnVja2V0JyxcbiAgICAgICAgfSxcbiAgICAgICAgUmVzb3VyY2VUeXBlOiAnQVdTOjpTMzo6QnVja2V0JyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIExvZ2ljYWxSZXNvdXJjZUlkOiAnbXktZWMyLWluc3RhbmNlJyxcbiAgICAgICAgTWFuYWdlZEJ5U3RhY2s6IHRydWUsXG4gICAgICAgIFJlc291cmNlSWRlbnRpZmllcjoge1xuICAgICAgICAgIGluc3RhbmNlSWQ6ICdpLTEyMzQ1Njc4OTBhYmNkZWYwJyxcbiAgICAgICAgfSxcbiAgICAgICAgUmVzb3VyY2VUeXBlOiAnQVdTOjpFQzI6Okluc3RhbmNlJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgfTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBzZGtQcm92aWRlciA9IG5ldyBNb2NrU2RrUHJvdmlkZXIoKTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzID0ge1xuICAgICAgc3RhcnRSZXNvdXJjZVNjYW46IGplc3QuZm4oKSxcbiAgICAgIGxpc3RSZXNvdXJjZVNjYW5zOiBqZXN0LmZuKCksXG4gICAgICBkZXNjcmliZVJlc291cmNlU2NhbjogamVzdC5mbigpLFxuICAgICAgbGlzdFJlc291cmNlU2NhblJlc291cmNlczogamVzdC5mbigpLFxuICAgICAgY3JlYXRlR2VuZXJhdGVkVGVtcGxhdGU6IGplc3QuZm4oKSxcbiAgICAgIGRlc2NyaWJlR2VuZXJhdGVkVGVtcGxhdGU6IGplc3QuZm4oKSxcbiAgICAgIGdldEdlbmVyYXRlZFRlbXBsYXRlOiBqZXN0LmZuKCksXG4gICAgICBsaXN0UmVzb3VyY2VTY2FuUmVsYXRlZFJlc291cmNlczogamVzdC5mbigpLFxuICAgICAgY29uZmlnOiB7XG4gICAgICAgIGdldENyZWRlbnRpYWxzOiBqZXN0LmZuKCksXG4gICAgICAgIGdldFRva2VuOiBqZXN0LmZuKCksXG4gICAgICAgIGxvYWRGcm9tUGF0aDogamVzdC5mbigpLFxuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgICAgZ2V0UHJvbWlzZXNEZXBlbmRlbmN5OiBqZXN0LmZuKCksXG4gICAgICAgIHNldFByb21pc2VzRGVwZW5kZW5jeTogamVzdC5mbigpLFxuICAgICAgICBjdXN0b21Vc2VyQWdlbnQ6ICdjZGstbWlncmF0ZScsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBzZGtQcm92aWRlci5zdHViQ2xvdWRGb3JtYXRpb24oY2xvdWRGb3JtYXRpb25Nb2NrcyBhcyBhbnkpO1xuICB9KTtcblxuICB0ZXN0KCdnZW5lcmF0ZVRlbXBsYXRlIHN1Y2Nlc3NmdWxseSBnZW5lcmF0ZXMgdGVtcGxhdGUgd2l0aCBhIG5ldyBzY2FuJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc291cmNlU2NhblN1bW1hcmllcyA9IFt7IFJlc291cmNlU2NhbklkOiBzY2FuSWQsIFN0YXR1czogJ0NPTVBMRVRFJywgUGVyY2VudGFnZUNvbXBsZXRlZDogMTAwIH1dO1xuXG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5zdGFydFJlc291cmNlU2NhbiEubW9ja1JldHVyblZhbHVlKHsgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5zIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZVNjYW5TdW1tYXJpZXM6IHJlc291cmNlU2NhblN1bW1hcmllcyB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmRlc2NyaWJlUmVzb3VyY2VTY2FuIS5tb2NrUmV0dXJuVmFsdWUoeyBTdGF0dXM6ICdDT01QTEVURUQnIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MubGlzdFJlc291cmNlU2NhblJlc291cmNlcyEubW9ja1JldHVyblZhbHVlKHsgUmVzb3VyY2VzOiBbc2FtcGxlUmVzb3VyY2UyXSB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmNyZWF0ZUdlbmVyYXRlZFRlbXBsYXRlIS5tb2NrUmV0dXJuVmFsdWUoeyBHZW5lcmF0ZWRUZW1wbGF0ZUlkOiAndGVtcGxhdGUtYXJuJyB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmRlc2NyaWJlR2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IFN0YXR1czogJ0NPTVBMRVRFJywgUmVzb3VyY2VzOiBbc2FtcGxlUmVzb3VyY2UsIHNhbXBsZVJlc291cmNlMl0gfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5nZXRHZW5lcmF0ZWRUZW1wbGF0ZSEubW9ja1JldHVyblZhbHVlKHsgVGVtcGxhdGVCb2R5OiAndGVtcGxhdGUtYm9keScgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FuUmVsYXRlZFJlc291cmNlcyEubW9ja1JldHVyblZhbHVlKHsgUmVsYXRlZFJlc291cmNlczogW3NhbXBsZVJlc291cmNlXSB9KTtcblxuICAgIGNvbnN0IG9wdHM6IEdlbmVyYXRlVGVtcGxhdGVPcHRpb25zID0ge1xuICAgICAgc3RhY2tOYW1lOiBzdGFja05hbWUsXG4gICAgICBmaWx0ZXJzOiBbXSxcbiAgICAgIGZyb21TY2FuOiBGcm9tU2Nhbi5ORVcsXG4gICAgICBzZGtQcm92aWRlcjogc2RrUHJvdmlkZXIsXG4gICAgICBlbnZpcm9ubWVudDogZW52aXJvbm1lbnQsXG4gICAgfTtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVUZW1wbGF0ZShvcHRzKTtcbiAgICBleHBlY3QodGVtcGxhdGUpLnRvRXF1YWwoZGVmYXVsdEV4cGVjdGVkUmVzdWx0KTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVUZW1wbGF0ZSBzdWNjZXNzZnVsbHkgZGVmYXVsdHMgdG8gbGF0ZXN0IHNjYW4gaW5zdGVhZCBvZiBzdGFydGluZyBhIG5ldyBvbmUnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyeUNvbXBsZXRlID0gW3sgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCwgU3RhdHVzOiAnQ09NUExFVEUnLCBQZXJjZW50YWdlQ29tcGxldGVkOiAxMDAgfV07XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyeUluUHJvZ3Jlc3MgPSBbeyBSZXNvdXJjZVNjYW5JZDogc2NhbklkLCBTdGF0dXM6ICdJTl9QUk9HUkVTUycsIFBlcmNlbnRhZ2VDb21wbGV0ZWQ6IDUwIH1dO1xuXG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5zdGFydFJlc291cmNlU2NhbiEubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdObyA+OignKTsgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FucyEubW9ja1JldHVyblZhbHVlT25jZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyeUluUHJvZ3Jlc3MgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FucyEubW9ja1JldHVyblZhbHVlT25jZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyeUNvbXBsZXRlIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVSZXNvdXJjZVNjYW4hLm1vY2tSZXR1cm5WYWx1ZSh7IFN0YXR1czogJ0NPTVBMRVRFRCcgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FuUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZTJdIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuY3JlYXRlR2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IEdlbmVyYXRlZFRlbXBsYXRlSWQ6ICd0ZW1wbGF0ZS1hcm4nIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVHZW5lcmF0ZWRUZW1wbGF0ZSEubW9ja1JldHVyblZhbHVlKHsgU3RhdHVzOiAnQ09NUExFVEUnLCBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZSwgc2FtcGxlUmVzb3VyY2UyXSB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmdldEdlbmVyYXRlZFRlbXBsYXRlIS5tb2NrUmV0dXJuVmFsdWUoeyBUZW1wbGF0ZUJvZHk6ICd0ZW1wbGF0ZS1ib2R5JyB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5SZWxhdGVkUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZWxhdGVkUmVzb3VyY2VzOiBbc2FtcGxlUmVzb3VyY2UyXSB9KTtcblxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICBzdGFja05hbWU6IHN0YWNrTmFtZSxcbiAgICAgIGZpbHRlcnM6IFtdLFxuICAgICAgbmV3U2NhbjogdHJ1ZSxcbiAgICAgIHNka1Byb3ZpZGVyOiBzZGtQcm92aWRlcixcbiAgICAgIGVudmlyb25tZW50OiBlbnZpcm9ubWVudCxcbiAgICB9O1xuICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVUZW1wbGF0ZShvcHRzKTtcbiAgICBleHBlY3QodGVtcGxhdGUpLnRvRXF1YWwoZGVmYXVsdEV4cGVjdGVkUmVzdWx0KTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVUZW1wbGF0ZSB0aHJvd3MgYW4gZXJyb3Igd2hlbiBmcm9tLXNjYW4gbW9zdC1yZWNlbnQgaXMgcGFzc2VkIGJ1dCBubyBzY2FucyBhcmUgZm91bmQuJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc291cmNlU2NhblN1bW1hcmllczogQ2xvdWRGb3JtYXRpb24uUmVzb3VyY2VTY2FuU3VtbWFyeVtdID0gW107XG5cbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5zIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZVNjYW5TdW1tYXJpZXM6IHJlc291cmNlU2NhblN1bW1hcmllcyB9KTtcblxuICAgIGNvbnN0IG9wdHM6IEdlbmVyYXRlVGVtcGxhdGVPcHRpb25zID0ge1xuICAgICAgc3RhY2tOYW1lOiBzdGFja05hbWUsXG4gICAgICBmaWx0ZXJzOiBbXSxcbiAgICAgIGZyb21TY2FuOiBGcm9tU2Nhbi5NT1NUX1JFQ0VOVCxcbiAgICAgIHNka1Byb3ZpZGVyOiBzZGtQcm92aWRlcixcbiAgICAgIGVudmlyb25tZW50OiBlbnZpcm9ubWVudCxcbiAgICB9O1xuICAgIGF3YWl0IGV4cGVjdChnZW5lcmF0ZVRlbXBsYXRlKG9wdHMpKS5yZWplY3RzLnRvVGhyb3coJ05vIHNjYW5zIGZvdW5kLiBQbGVhc2UgZWl0aGVyIHN0YXJ0IGEgbmV3IHNjYW4gd2l0aCB0aGUgYC0tZnJvbS1zY2FuYCBuZXcgb3IgZG8gbm90IHNwZWNpZnkgYSBgLS1mcm9tLXNjYW5gIG9wdGlvbi4nKTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVUZW1wbGF0ZSB0aHJvd3MgYW4gZXJyb3Igd2hlbiBhbiBpbnZhbGlkIGtleSBpcyBwYXNzZWQgaW4gdGhlIGZpbHRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyaWVzID0gW3sgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCwgU3RhdHVzOiAnQ09NUExFVEUnLCBQZXJjZW50YWdlQ29tcGxldGVkOiAxMDAgfV07XG5cbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLnN0YXJ0UmVzb3VyY2VTY2FuIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZVNjYW5JZDogc2NhbklkIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MubGlzdFJlc291cmNlU2NhbnMhLm1vY2tSZXR1cm5WYWx1ZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyaWVzIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVSZXNvdXJjZVNjYW4hLm1vY2tSZXR1cm5WYWx1ZSh7IFN0YXR1czogJ0NPTVBMRVRFRCcgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FuUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZTJdIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuY3JlYXRlR2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IEdlbmVyYXRlZFRlbXBsYXRlSWQ6ICd0ZW1wbGF0ZS1hcm4nIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVHZW5lcmF0ZWRUZW1wbGF0ZSEubW9ja1JldHVyblZhbHVlKHsgU3RhdHVzOiAnQ09NUExFVEUnIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZ2V0R2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IFRlbXBsYXRlQm9keTogJ3RlbXBsYXRlLWJvZHknIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MubGlzdFJlc291cmNlU2NhblJlbGF0ZWRSZXNvdXJjZXMhLm1vY2tSZXR1cm5WYWx1ZSh7IFJlbGF0ZWRSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZV0gfSk7XG5cbiAgICBjb25zdCBvcHRzOiBHZW5lcmF0ZVRlbXBsYXRlT3B0aW9ucyA9IHtcbiAgICAgIHN0YWNrTmFtZTogc3RhY2tOYW1lLFxuICAgICAgZmlsdGVyczogWydpbnZhbGlkLWtleT1pbnZhbGlkLXZhbHVlJ10sXG4gICAgICBmcm9tU2NhbjogRnJvbVNjYW4uTU9TVF9SRUNFTlQsXG4gICAgICBzZGtQcm92aWRlcjogc2RrUHJvdmlkZXIsXG4gICAgICBlbnZpcm9ubWVudDogZW52aXJvbm1lbnQsXG4gICAgfTtcbiAgICBhd2FpdCBleHBlY3QoZ2VuZXJhdGVUZW1wbGF0ZShvcHRzKSkucmVqZWN0cy50b1Rocm93KCdJbnZhbGlkIGZpbHRlcjogaW52YWxpZC1rZXknKTtcbiAgfSk7XG5cbiAgdGVzdCgnZ2VuZXJhdGVUZW1wbGF0ZSBkZWZhdWx0cyB0byBzdGFydGluZyBhIG5ldyBzY2FuIHdoZW4gbm8gb3B0aW9ucyBhcmUgcHJvdmlkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyeUNvbXBsZXRlID0gW3sgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCwgU3RhdHVzOiAnQ09NUExFVEUnLCBQZXJjZW50YWdlQ29tcGxldGVkOiAxMDAgfV07XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyeUluUHJvZ3Jlc3MgPSBbeyBSZXNvdXJjZVNjYW5JZDogc2NhbklkLCBTdGF0dXM6ICdJTl9QUk9HUkVTUycsIFBlcmNlbnRhZ2VDb21wbGV0ZWQ6IDUwIH1dO1xuXG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5zdGFydFJlc291cmNlU2NhbiEubW9ja1JldHVyblZhbHVlKHsgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5zIS5tb2NrUmV0dXJuVmFsdWVPbmNlKHsgUmVzb3VyY2VTY2FuU3VtbWFyaWVzOiB1bmRlZmluZWQgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FucyEubW9ja1JldHVyblZhbHVlT25jZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyeUluUHJvZ3Jlc3MgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FucyEubW9ja1JldHVyblZhbHVlT25jZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyeUNvbXBsZXRlIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVSZXNvdXJjZVNjYW4hLm1vY2tSZXR1cm5WYWx1ZSh7IFN0YXR1czogJ0NPTVBMRVRFRCcgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FuUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZTJdIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuY3JlYXRlR2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IEdlbmVyYXRlZFRlbXBsYXRlSWQ6ICd0ZW1wbGF0ZS1hcm4nIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVHZW5lcmF0ZWRUZW1wbGF0ZSEubW9ja1JldHVyblZhbHVlKHsgU3RhdHVzOiAnQ09NUExFVEUnLCBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZSwgc2FtcGxlUmVzb3VyY2UyXSB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmdldEdlbmVyYXRlZFRlbXBsYXRlIS5tb2NrUmV0dXJuVmFsdWUoeyBUZW1wbGF0ZUJvZHk6ICd0ZW1wbGF0ZS1ib2R5JyB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5SZWxhdGVkUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZWxhdGVkUmVzb3VyY2VzOiBbc2FtcGxlUmVzb3VyY2VdIH0pO1xuXG4gICAgY29uc3Qgb3B0czogR2VuZXJhdGVUZW1wbGF0ZU9wdGlvbnMgPSB7XG4gICAgICBzdGFja05hbWU6IHN0YWNrTmFtZSxcbiAgICAgIHNka1Byb3ZpZGVyOiBzZGtQcm92aWRlcixcbiAgICAgIGVudmlyb25tZW50OiBlbnZpcm9ubWVudCxcbiAgICB9O1xuICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgZ2VuZXJhdGVUZW1wbGF0ZShvcHRzKTtcbiAgICBleHBlY3QodGVtcGxhdGUpLnRvRXF1YWwoZGVmYXVsdEV4cGVjdGVkUmVzdWx0KTtcbiAgICBleHBlY3QoY2xvdWRGb3JtYXRpb25Nb2Nrcy5zdGFydFJlc291cmNlU2NhbikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICB9KTtcblxuICB0ZXN0KCdnZW5lcmF0ZVRlbXBsYXRlIHN1Y2Nlc3NmdWxseSBnZW5lcmF0ZXMgdGVtcGxhdGVzIHdpdGggdmFsaWQgZmlsdGVyIG9wdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VTY2FuU3VtbWFyaWVzID0gW3sgUmVzb3VyY2VTY2FuSWQ6IHNjYW5JZCwgU3RhdHVzOiAnQ09NUExFVEUnLCBQZXJjZW50YWdlQ29tcGxldGVkOiAxMDAgfV07XG5cbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLnN0YXJ0UmVzb3VyY2VTY2FuIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZVNjYW5JZDogc2NhbklkIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MubGlzdFJlc291cmNlU2NhbnMhLm1vY2tSZXR1cm5WYWx1ZSh7IFJlc291cmNlU2NhblN1bW1hcmllczogcmVzb3VyY2VTY2FuU3VtbWFyaWVzIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVSZXNvdXJjZVNjYW4hLm1vY2tSZXR1cm5WYWx1ZSh7IFN0YXR1czogJ0NPTVBMRVRFRCcgfSk7XG4gICAgY2xvdWRGb3JtYXRpb25Nb2Nrcy5saXN0UmVzb3VyY2VTY2FuUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZTJdIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuY3JlYXRlR2VuZXJhdGVkVGVtcGxhdGUhLm1vY2tSZXR1cm5WYWx1ZSh7IEdlbmVyYXRlZFRlbXBsYXRlSWQ6ICd0ZW1wbGF0ZS1hcm4nIH0pO1xuICAgIGNsb3VkRm9ybWF0aW9uTW9ja3MuZGVzY3JpYmVHZW5lcmF0ZWRUZW1wbGF0ZSEubW9ja1JldHVyblZhbHVlKHsgU3RhdHVzOiAnQ09NUExFVEUnLCBSZXNvdXJjZXM6IFtzYW1wbGVSZXNvdXJjZSwgc2FtcGxlUmVzb3VyY2UyXSB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmdldEdlbmVyYXRlZFRlbXBsYXRlIS5tb2NrUmV0dXJuVmFsdWUoeyBUZW1wbGF0ZUJvZHk6ICd0ZW1wbGF0ZS1ib2R5JyB9KTtcbiAgICBjbG91ZEZvcm1hdGlvbk1vY2tzLmxpc3RSZXNvdXJjZVNjYW5SZWxhdGVkUmVzb3VyY2VzIS5tb2NrUmV0dXJuVmFsdWUoeyBSZWxhdGVkUmVzb3VyY2VzOiBbc2FtcGxlUmVzb3VyY2VdIH0pO1xuXG4gICAgY29uc3Qgb3B0czogR2VuZXJhdGVUZW1wbGF0ZU9wdGlvbnMgPSB7XG4gICAgICBzdGFja05hbWU6IHN0YWNrTmFtZSxcbiAgICAgIGZpbHRlcnM6IFsndHlwZT1BV1M6OlMzOjpCdWNrZXQsaWRlbnRpZmllcj17XCJteS1rZXlcIjpcIm15LWJ1Y2tldFwifScsICd0eXBlPUFXUzo6RUMyOjpJbnN0YW5jZSddLFxuICAgICAgc2RrUHJvdmlkZXI6IHNka1Byb3ZpZGVyLFxuICAgICAgZW52aXJvbm1lbnQ6IGVudmlyb25tZW50LFxuICAgIH07XG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBnZW5lcmF0ZVRlbXBsYXRlKG9wdHMpO1xuICAgIGV4cGVjdCh0ZW1wbGF0ZSkudG9FcXVhbChkZWZhdWx0RXhwZWN0ZWRSZXN1bHQpO1xuICB9KTtcblxufSk7Il19